<!DOCTYPE html>
<!--[if IE 8]> <html lang="en" class="ie8 no-js"> <![endif]-->
<!--[if IE 9]> <html lang="en" class="ie9 no-js"> <![endif]-->
<!--[if !IE]><!-->
<html lang="en">
<!--<![endif]-->
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  
  <title>glmapper</title>

  <meta content="width=device-width, initial-scale=1.0" name="viewport">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

  <meta name="description" content="从平凡的世界中全身而退">
<meta property="og:type" content="website">
<meta property="og:title" content="glmapper">
<meta property="og:url" content="http://www.glmapper.com/page/11/index.html">
<meta property="og:site_name" content="glmapper">
<meta property="og:description" content="从平凡的世界中全身而退">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="glmapper">
<meta name="twitter:description" content="从平凡的世界中全身而退">
  
    <link rel="alternative" href="/atom.xml" title="glmapper" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
    
  <meta content="{{ title }}" name="description">
  <meta content="{{ title }}" name="keywords">
  <meta content="{{ title }}" name="author">

  <link href="http://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700|PT+Sans+Narrow|Source+Sans+Pro:200,300,400,600,700,900&amp;subset=all" rel="stylesheet" type="text/css">

  <!-- Global styles START -->   
  <link rel="stylesheet" href="/metronic/assets/plugins/font-awesome/css/font-awesome.min.css">
  <link rel="stylesheet" href="/metronic/assets/plugins/bootstrap/css/bootstrap.min.css">
  <!-- Global styles END --> 
   
  <!-- Page level plugin styles START -->
  <link rel="stylesheet" href="/metronic/assets/pages/css/animate.css">
  <link rel="stylesheet" href="/metronic/assets/plugins/owl.carousel/assets/owl.carousel.css">
  <!-- Page level plugin styles END -->

  <!-- Theme styles START -->
  <link rel="stylesheet" href="/metronic/assets/pages/css/components.css">
  <link rel="stylesheet" href="/metronic/assets/pages/css/slider.css">
  <link rel="stylesheet" href="/metronic/assets/corporate/css/style.css">
  <link rel="stylesheet" href="/metronic/assets/pages/css/portfolio.css">
  <link rel="stylesheet" href="/metronic/assets/corporate/css/style-responsive.css">
  <link rel="stylesheet" href="/metronic/assets/corporate/css/themes/red.css">
  <link rel="stylesheet" href="/css/theme-styles.css">
  <!-- Theme styles END -->
</head>
</html>
<body class="corporate">
  <!-- BEGIN TOP BAR -->
<div class="pre-header">
  <div class="container">
    <div class="row">
      <!-- BEGIN TOP BAR LEFT PART -->
      <div class="col-md-6 col-sm-6 col-xs-9 additional-shop-info">
	<ul class="list-unstyled list-inline">
	  <li><i class="fa fa-phone"></i><span>716-472-4484</span></li>
	  <li><i class="fa fa-envelope-o"></i><span>ptsteadman@gmail.com</span></li>
	</ul>
      </div>
      <!-- END TOP BAR LEFT PART -->
      <!-- BEGIN TOP BAR MENU -->
      <div class="col-md-6 col-sm-6 col-xs-3 additional-nav">
	<ul class="list-unstyled list-inline pull-right">
	  <li><a href="/login">Log In</a></li>
	</ul>
      </div>
      <!-- END TOP BAR MENU -->
    </div>
  </div>        
</div>
<!-- END TOP BAR -->
<!-- BEGIN HEADER -->
<div class="header">
  <div class="container">
    <!--<a class="site-logo" href="/" id="logo">glmapper</a>-->

    <a class="site-logo" href="/">
      <img src="/metronic/assets/corporate/img/logos/logo-corp-red.png" alt="Metronic FrontEnd">
    </a>

    <a href="javascript:void(0);" class="mobi-toggler"><i class="fa fa-bars"></i></a>

    <!-- BEGIN NAVIGATION -->
    <div class="header-navigation pull-right font-transform-inherit">
      <ul>
	
	<li class="">
	  <a href="/">Home</a>
	</li>
	
	<li class="">
	  <a href="/projects/">Projects</a>
	</li>
	
	<li class="">
	  <a href="/archives/">Blog</a>
	</li>
	
	<li class="">
	  <a href="/contact/">Contact</a>
	</li>
	
	<li class="">
	  <a href="/about/">About</a>
	</li>
	
	<!-- BEGIN TOP SEARCH -->
	<li class="menu-search">
	  <span class="sep"></span>
	  <i class="fa fa-search search-btn"></i>
	  <div class="search-box">
	    <form action="#">
	      <div class="input-group">
		<input type="text" placeholder="Search" class="form-control st-default-search-input">
		<span class="input-group-btn">
		  <button class="btn btn-primary" type="submit">Search</button>
		</span>
	      </div>
	    </form>
	  </div> 
	</li>
	<!-- END TOP SEARCH -->
      </ul>
    </div>
    <!-- END NAVIGATION -->
  </div>
</div>
<!-- Header END -->

  
  <div class="container">
    <ul class="breadcrumb">
      <li class="active">Home</li>
    </ul>
  <div id="main">
    <div class="row">

<div class="col-xs-12 blog-posts">


  <section class="archives-wrap">
    <div class="archives">
      
	<div class="row">
  <div class="col-md-4 col-sm-4">
    
  </div>
  
    <div class="col-xs-12">
  
    
    <h2 itemprop="name">
      <a class="archive-article-title" href="/2018/11/10/spring-series-starting/">Spring源码系列：Spring的启动过程</a>
    </h2>


    <ul class="blog-info">
      <li>
      	<i class="fa fa-calendar"></i> 
        <time datetime="2018-11-10T05:37:30.000Z" itemprop="datePublished">2018/11/10</time>

      </li>
      <li><i class="fa fa-comments"></i>
        <a href="http://www.glmapper.com/2018/11/10/spring-series-starting/#disqus_thread" class="article-comment-link">Comments</a>
      </li>
      <li>
	<i class="fa fa-tags"></i>
	
  
    <a href="/tags/spring/" title="spring">spring</a>
  


      </li>
    </ul>
    <div class="blog-item">
      
	<p>Spring对于程序员说来说都不陌生；作为一个强大的开源技术，帮助我们能够更好的进行项目的开发与维护。<br>直接进入主题吧。Spring的启动过程实际上就是Ioc容器初始化以及载入Bean的过程；本文主要是学习记录下前半部分（Ioc容器的初始化），新手上路，如有错误，请指正！<br>1.从配置文件说起</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">listener</span>&gt;</span>  </span><br><span class="line">     <span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener</span><br><span class="line">     <span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">listener</span>&gt;</span> </span><br><span class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span>  </span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:applicationContext.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span>  </span><br><span class="line"><span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>在一般的WEB项目中，项目的启动一般是从web.xml文件的载入开始的。如果我们的项目中使用了Spring，那么你肯定会在你的web.xml文件中看到上面的配置。Spring正是通过ContextLoaderListener监听器来进行容器初始化的。下面通过代码进行分析。</p>
<p>2.Spring容器加载的三步走</p>
<ul>
<li>step1:创建一个WebApplicationContext</li>
<li>step2:配置并且刷新Bean</li>
<li>step3：将容器初始化到servlet上下文中</li>
</ul>
<p>3.WebApplicationContext的创建过程<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ContextLoaderListener</span> <span class="keyword">extends</span> <span class="title">ContextLoader</span> <span class="keyword">implements</span> <span class="title">ServletContextListener</span></span></span><br></pre></td></tr></table></figure></p>
<p>从ContextLoaderListener的定义可以看出，该监听器继承了ContextLoader，并且重写了ServletContextListener中的contextInitialized和contextDestroyed方法。</p>
<p>在contextInitialized中，通过调用父类（ContextLoader）的initWebApplicationContext方法进行容器创建：<br><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">contextInitialized</span><span class="params">(ServletContextEvent event)</span> </span>&#123;</span><br><span class="line">    initWebApplicationContext(event.getServletContext());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>下面来看initWebApplicationContext的代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> WebApplicationContext <span class="title">initWebApplicationContext</span><span class="params">(ServletContext servletContext)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//1：判断当前容器是否存在，如果存在则报容器已经存在的异常信息</span></span><br><span class="line">    <span class="keyword">if</span> (servletContext.getAttribute(WebApplicationContext.ROOT_WEB_APPLICATION_CONTEXT_ATTRIBUTE) != <span class="keyword">null</span>) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException(</span><br><span class="line">          <span class="string">"Cannot initialize context because there is already a root application context present - "</span> +</span><br><span class="line">          <span class="string">"check whether you have multiple ContextLoader* definitions in your web.xml!"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    Log logger = LogFactory.getLog(ContextLoader.class);</span><br><span class="line">    <span class="comment">//下面这个日志就是我们经常在启动Spring项目时看到的日志信息: </span></span><br><span class="line">    <span class="comment">//Initializing Spring root WebApplicationContext</span></span><br><span class="line">    <span class="comment">//Root WebApplicationContext: initialization started</span></span><br><span class="line">    servletContext.log(<span class="string">"Initializing Spring root WebApplicationContext"</span>);</span><br><span class="line">    <span class="keyword">if</span> (logger.isInfoEnabled()) &#123;</span><br><span class="line">      logger.info(<span class="string">"Root WebApplicationContext: initialization started"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">long</span> startTime = System.currentTimeMillis();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">      <span class="comment">// Store context in local instance variable, to guarantee that</span></span><br><span class="line">      <span class="comment">// it is available on ServletContext shutdown.</span></span><br><span class="line">      <span class="comment">//如果当前容器为null,则创建一个容器，并将servletContext上下文作为参数传递进去，</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">this</span>.context == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">this</span>.context = createWebApplicationContext(servletContext);</span><br><span class="line">      &#125;</span><br><span class="line">       <span class="comment">//判断当前容器是否为可配置的，只有是Configurable的容器，才能进行后续的配置</span></span><br><span class="line">      <span class="keyword">if</span> (<span class="keyword">this</span>.context <span class="keyword">instanceof</span> ConfigurableWebApplicationContext) &#123;</span><br><span class="line">        ConfigurableWebApplicationContext cwac = (ConfigurableWebApplicationContext) <span class="keyword">this</span>.context;</span><br><span class="line">        <span class="keyword">if</span> (!cwac.isActive()) &#123;</span><br><span class="line">          <span class="comment">// The context has not yet been refreshed -&gt; provide services such as</span></span><br><span class="line">          <span class="comment">// setting the parent context, setting the application context id, etc</span></span><br><span class="line">          <span class="keyword">if</span> (cwac.getParent() == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="comment">// The context instance was injected without an explicit parent -&gt;</span></span><br><span class="line">            <span class="comment">// determine parent for root web application context, if any.</span></span><br><span class="line">            ApplicationContext parent = loadParentContext(servletContext);</span><br><span class="line">            cwac.setParent(parent);</span><br><span class="line">          &#125;</span><br><span class="line">           <span class="comment">//三步走中的第二步：配置并且刷新当前容器</span></span><br><span class="line">          configureAndRefreshWebApplicationContext(cwac, servletContext);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">       <span class="comment">//将配置并且刷新过的容器存入servlet上下文中，并以WebApplicationContext的类名作为key值</span></span><br><span class="line"></span><br><span class="line">      servletContext.setAttribute(WebApplicationContext.ROOT_WEB_APPLICATION_CONTEXT_ATTRIBUTE, <span class="keyword">this</span>.context);</span><br><span class="line"></span><br><span class="line">      ClassLoader ccl = Thread.currentThread().getContextClassLoader();</span><br><span class="line">      <span class="keyword">if</span> (ccl == ContextLoader.class.getClassLoader()) &#123;</span><br><span class="line">        currentContext = <span class="keyword">this</span>.context;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span> <span class="keyword">if</span> (ccl != <span class="keyword">null</span>) &#123;</span><br><span class="line">        currentContextPerThread.put(ccl, <span class="keyword">this</span>.context);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (logger.isDebugEnabled()) &#123;</span><br><span class="line">        logger.debug(<span class="string">"Published root WebApplicationContext as ServletContext attribute with name ["</span> +</span><br><span class="line">            WebApplicationContext.ROOT_WEB_APPLICATION_CONTEXT_ATTRIBUTE + <span class="string">"]"</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (logger.isInfoEnabled()) &#123;</span><br><span class="line">        <span class="keyword">long</span> elapsedTime = System.currentTimeMillis() - startTime;</span><br><span class="line">        logger.info(<span class="string">"Root WebApplicationContext: initialization completed in "</span> + elapsedTime + <span class="string">" ms"</span>);</span><br><span class="line">      &#125;</span><br><span class="line">       <span class="comment">//返回创建好的容器</span></span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">this</span>.context;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (RuntimeException ex) &#123;</span><br><span class="line">      logger.error(<span class="string">"Context initialization failed"</span>, ex);</span><br><span class="line">      servletContext.setAttribute(WebApplicationContext.ROOT_WEB_APPLICATION_CONTEXT_ATTRIBUTE, ex);</span><br><span class="line">      <span class="keyword">throw</span> ex;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">catch</span> (Error err) &#123;</span><br><span class="line">      logger.error(<span class="string">"Context initialization failed"</span>, err);</span><br><span class="line">      servletContext.setAttribute(WebApplicationContext.ROOT_WEB_APPLICATION_CONTEXT_ATTRIBUTE, err);</span><br><span class="line">      <span class="keyword">throw</span> err;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>下面我们在看下是如何创建WebApplicationContext的</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> WebApplicationContext <span class="title">createWebApplicationContext</span><span class="params">(ServletContext sc)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//首先来确定context是由什么类定义的，并且判断当前容器是否为可配置的</span></span><br><span class="line">    Class&lt;?&gt; contextClass = determineContextClass(sc);</span><br><span class="line">    <span class="keyword">if</span> (!ConfigurableWebApplicationContext.class.isAssignableFrom(contextClass)) &#123;</span><br><span class="line">      <span class="keyword">throw</span> <span class="keyword">new</span> ApplicationContextException(<span class="string">"Custom context class ["</span> + contextClass.getName() +</span><br><span class="line">          <span class="string">"] is not of type ["</span> + ConfigurableWebApplicationContext.class.getName() + <span class="string">"]"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//创建可配置的上下文容器</span></span><br><span class="line">    <span class="keyword">return</span> (ConfigurableWebApplicationContext) BeanUtils.instantiateClass(contextClass);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>最后来看下determineContextClass这个方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">protected</span> Class&lt;?&gt; determineContextClass(ServletContext servletContext) &#123;</span><br><span class="line">    <span class="comment">//首先从web.xml中查看用户是否自己定义了context</span></span><br><span class="line">    String contextClassName = servletContext.getInitParameter(CONTEXT_CLASS_PARAM);</span><br><span class="line">    <span class="comment">//如果有，则通过反射创建实例</span></span><br><span class="line">    <span class="keyword">if</span> (contextClassName != <span class="keyword">null</span>) &#123;</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> ClassUtils.forName(contextClassName, ClassUtils.getDefaultClassLoader());</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">catch</span> (ClassNotFoundException ex) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> ApplicationContextException(</span><br><span class="line">            <span class="string">"Failed to load custom context class ["</span> + contextClassName + <span class="string">"]"</span>, ex);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*如果没有，则去defaultStrategies里面取【defaultStrategies是Propertites类的/对象，在ContextLoader中的静态代码块中初始化的；具体可看下下面的图像】；默认容器是XmlWebApplicationContext*/</span></span><br><span class="line">  <span class="keyword">else</span> &#123;</span><br><span class="line">   contextClassName = defaultStrategies.getProperty(WebApplicationContext.class.getName());</span><br><span class="line">      <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> ClassUtils.forName(contextClassName, ContextLoader.class.getClassLoader());</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">catch</span> (ClassNotFoundException ex) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> ApplicationContextException(</span><br><span class="line">            <span class="string">"Failed to load default context class ["</span> + contextClassName + <span class="string">"]"</span>, ex);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>总的来说就是：Spring的web工程首先回去检查用户是否自己定义了context，如果有就采用；如果没有就使用Spring默认的。<br>defaultStrategies初始化：<br><img src="https://user-gold-cdn.xitu.io/2017/8/27/62ee7d396cdab1a3636d6d4237b4ca76" alt=""></p>
<p>至此，容器创建完成。下面是整个过程的一个流程图（有疏漏，回头补一个时序图）：</p>
<p><img src="https://user-gold-cdn.xitu.io/2017/8/27/f4fe5698c40759d2a1eadb1a0d390f91" alt=""></p>

      
    </div>
    <br>
    <br>
    <a href="http://www.glmapper.com/2018/11/10/spring-series-starting/" class="more">Read more <i class="icon-angle-right"></i></a>
  </div>
</div>
<hr class="blog-post-sep">

      
	<div class="row">
  <div class="col-md-4 col-sm-4">
    
  </div>
  
    <div class="col-xs-12">
  
    
    <h2 itemprop="name">
      <a class="archive-article-title" href="/2018/11/10/java-key-word/">JAVA中的关键字</a>
    </h2>


    <ul class="blog-info">
      <li>
      	<i class="fa fa-calendar"></i> 
        <time datetime="2018-11-10T05:35:57.000Z" itemprop="datePublished">2018/11/10</time>

      </li>
      <li><i class="fa fa-comments"></i>
        <a href="http://www.glmapper.com/2018/11/10/java-key-word/#disqus_thread" class="article-comment-link">Comments</a>
      </li>
      <li>
	<i class="fa fa-tags"></i>
	
  
    <a href="/tags/java/" title="java">java</a>
  


      </li>
    </ul>
    <div class="blog-item">
      
	<p>Java中关键字有51个，另外还有俩个保留字；因此总共有53个。本文只将java中的关键字进行罗列和简单介绍，对于部分关键字的理解如sychronized将在其他文章中单独分析。</p>
<h2 id="保留字"><a href="#保留字" class="headerlink" title="保留字"></a>保留字</h2><p>保留字是指预留的关键字；</p>
<ul>
<li>const<br>用于修饰字段或局部变量的声明；被const修饰的字段或局部变量的值是常数，不能被修改</li>
<li>goto<br>指定跳转到标签，找到标签后，程序将处理从下一行开始的命令。</li>
</ul>
<h2 id="关键字"><a href="#关键字" class="headerlink" title="关键字"></a>关键字</h2><ul>
<li>数据类型</li>
</ul>
<p><img src="https://user-gold-cdn.xitu.io/2018/2/24/161c56a5513a0b4c" alt=""></p>
<ul>
<li>访问修饰符</li>
</ul>
<p><img src="https://user-gold-cdn.xitu.io/2018/2/24/161c56d16e420180?w=554&amp;h=87&amp;f=png&amp;s=20781" alt=""></p>
<ul>
<li>类、接口定义相关</li>
</ul>
<p><img src="https://user-gold-cdn.xitu.io/2018/2/24/161c56e46c6eb13a?w=554&amp;h=236&amp;f=png&amp;s=75005" alt=""></p>
<ul>
<li>流程控制与判断相关</li>
</ul>
<p><img src="https://user-gold-cdn.xitu.io/2018/2/24/161c56e789b5734f?w=554&amp;h=440&amp;f=png&amp;s=99208" alt=""></p>
<ul>
<li>包</li>
</ul>
<p><img src="https://user-gold-cdn.xitu.io/2018/2/24/161c56e9ffbb75d0?w=555&amp;h=109&amp;f=png&amp;s=29835" alt=""></p>
<ul>
<li>变量\类\接口\方法修饰符</li>
</ul>
<p><img src="https://user-gold-cdn.xitu.io/2018/2/24/161c56ec204867be?w=555&amp;h=254&amp;f=png&amp;s=86733" alt=""></p>
<ul>
<li>异常处理</li>
</ul>
<p><img src="https://user-gold-cdn.xitu.io/2018/2/24/161c56ef12657a13?w=554&amp;h=130&amp;f=png&amp;s=34675" alt=""></p>
<ul>
<li>枚举和断言</li>
</ul>
<p><img src="https://user-gold-cdn.xitu.io/2018/2/24/161c56f13a85caea?w=555&amp;h=67&amp;f=png&amp;s=10210" alt=""></p>

      
    </div>
    <br>
    <br>
    <a href="http://www.glmapper.com/2018/11/10/java-key-word/" class="more">Read more <i class="icon-angle-right"></i></a>
  </div>
</div>
<hr class="blog-post-sep">

      
	<div class="row">
  <div class="col-md-4 col-sm-4">
    
  </div>
  
    <div class="col-xs-12">
  
    
    <h2 itemprop="name">
      <a class="archive-article-title" href="/2018/11/10/leetcode5/">每天一道算法题：无重复字符的最长子串</a>
    </h2>


    <ul class="blog-info">
      <li>
      	<i class="fa fa-calendar"></i> 
        <time datetime="2018-11-10T05:34:51.000Z" itemprop="datePublished">2018/11/10</time>

      </li>
      <li><i class="fa fa-comments"></i>
        <a href="http://www.glmapper.com/2018/11/10/leetcode5/#disqus_thread" class="article-comment-link">Comments</a>
      </li>
      <li>
	<i class="fa fa-tags"></i>
	
  
    <a href="/tags/算法/" title="算法">算法</a>,
  
    <a href="/tags/leetcode/" title="leetcode">leetcode</a>
  


      </li>
    </ul>
    <div class="blog-item">
      
	<h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><p><strong>给定一个字符串，找出不含有重复字符的 最长子串 的长度。</strong></p>
<p>示例：</p>
<ul>
<li><p>给定 “abcabcbb” ，没有重复字符的最长子串是 “abc” ，那么长度就是3。</p>
</li>
<li><p>给定 “bbbbb” ，最长的子串就是 “b” ，长度是1。</p>
</li>
<li><p>给定 “pwwkew” ，最长子串是 “wke” ，长度是3。请注意答案必须是一个子串，”pwke” 是 子序列 而不是子串。</p>
</li>
</ul>
<h2 id="方案1"><a href="#方案1" class="headerlink" title="方案1"></a>方案1</h2><p>思路：</p>
<ul>
<li><p>字符对应的数字作为下标</p>
</li>
<li><p>初始化一个255的boolean作为所有可能出现的字符对应的存在可能性，不存在重复的均为false，存在重复的，则对应的下标置为true。</p>
</li>
<li><p>两个指针进行移动，前指针先不动，后指针移动并根据当前字符对应整数下标是否为false或者true进行判断。如果是false，则表示没有重复，则指针向后移动一位；如果为true，表示存在重复，则后指针停止移动，并计算当前字串长度，且将boolean数组重置，第一个指针向前移动一位，后指针指向当前前指针。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">class Solution &#123;</span><br><span class="line">    public int lengthOfLongestSubstring(String s) &#123;</span><br><span class="line">         int len = 0 ;</span><br><span class="line"></span><br><span class="line">        if (s==null || s.length()== 0 )</span><br><span class="line">        &#123;</span><br><span class="line">            return 0;</span><br><span class="line">        &#125;</span><br><span class="line">        if (s.length() == 1)&#123;</span><br><span class="line"></span><br><span class="line">            return 1;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        int firstPoint = 0;</span><br><span class="line">        int nextPoint = 0;</span><br><span class="line"></span><br><span class="line">        boolean[] exist=new boolean[255];</span><br><span class="line"></span><br><span class="line">        while (nextPoint &lt; s.length()&amp;&amp;firstPoint &lt;s.length())&#123;</span><br><span class="line"></span><br><span class="line">            int currMax = 0;</span><br><span class="line">            int index = s.charAt(nextPoint)-0;</span><br><span class="line">            while (exist[index] == false&amp;&amp;nextPoint&lt;s.length())&#123;</span><br><span class="line">                exist[s.charAt(nextPoint)-0] = true;</span><br><span class="line">                nextPoint++;</span><br><span class="line">                if (nextPoint &lt; s.length())&#123;</span><br><span class="line">                    index = s.charAt(nextPoint)-0;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            currMax = Math.max(currMax,nextPoint-firstPoint);</span><br><span class="line">            firstPoint++;</span><br><span class="line">            nextPoint=firstPoint;</span><br><span class="line">            len = Math.max(len,currMax);</span><br><span class="line">            for (int i = 0 ; i &lt; 255 ; i++)</span><br><span class="line">            &#123;</span><br><span class="line">                exist[i] = false;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return len;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="方案2"><a href="#方案2" class="headerlink" title="方案2"></a>方案2</h2><p>思路：</p>
<p>以一个hashmap作为辅助，map的key存储的是字符，value存储的是该字符当前的位置，首先设置一个头指针，指向字符串开头，那么从开始遍历字符串，如果map当中不包含这个字符，那么用这个字符当前所在的位置减去头指针的位置，然后与最大长度做比较，选打的成为最大长度，然后把当前字符的以及位置放入map，以abba为例，头指针指向a，当前为a，那么长度为1，map。put（‘a’,0）,当前为b，那么长度为2，map.put(‘b’,1)，如果说map中存在当前字符，那么把头指针指向，头指针当前的位置与map中存储该字符位置的下一个位置当中的较大者，成为新的头指针位置，比如当走到第二个b的时候，那么头指针原来是0，当前map中存放b的位置是1，那么头指针指向2，所以长度为1，比最大长度小不进行替换，最后将当前的字符及位置放入map，现在是map.put(‘b’,2)，然后走到了a，那么当前map中a的位置是0，那么它的下一个位置是1，与当前头指针位置2相比，小于当前头指针的位置，那么头指针不跟新，所以长度为2，与最大长度相等，所以不替换，最后求出最大长度为2.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">public static int lengthOfLongestSubstring(String s) &#123;  </span><br><span class="line">        Map&lt;Character,Integer&gt; map=new HashMap&lt;Character,Integer&gt;();  </span><br><span class="line">        int maxLength=0;  </span><br><span class="line">        int now=0;  </span><br><span class="line">        for(int i=0;i&lt;s.length();i++)&#123;  </span><br><span class="line">            if(map.containsKey(s.charAt(i)))&#123;  </span><br><span class="line">                now=Math.max(map.get(s.charAt(i))+1,now);  </span><br><span class="line">                if((i-now+1)&gt;maxLength)&#123;  </span><br><span class="line">                    maxLength=i-now+1;  </span><br><span class="line">                &#125;  </span><br><span class="line">            &#125;else&#123;  </span><br><span class="line">                if((i-now+1)&gt;maxLength)&#123;  </span><br><span class="line">                    maxLength=i-now+1;  </span><br><span class="line">                &#125;  </span><br><span class="line">            &#125;  </span><br><span class="line">            map.put(s.charAt(i), i);  </span><br><span class="line">        &#125;  </span><br><span class="line">        return maxLength;  </span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <br>
    <br>
    <a href="http://www.glmapper.com/2018/11/10/leetcode5/" class="more">Read more <i class="icon-angle-right"></i></a>
  </div>
</div>
<hr class="blog-post-sep">

      
	<div class="row">
  <div class="col-md-4 col-sm-4">
    
  </div>
  
    <div class="col-xs-12">
  
    
    <h2 itemprop="name">
      <a class="archive-article-title" href="/2018/11/10/leetcode4/">每天一道算法题：求两个排序数组的中位数</a>
    </h2>


    <ul class="blog-info">
      <li>
      	<i class="fa fa-calendar"></i> 
        <time datetime="2018-11-10T05:34:04.000Z" itemprop="datePublished">2018/11/10</time>

      </li>
      <li><i class="fa fa-comments"></i>
        <a href="http://www.glmapper.com/2018/11/10/leetcode4/#disqus_thread" class="article-comment-link">Comments</a>
      </li>
      <li>
	<i class="fa fa-tags"></i>
	
  
    <a href="/tags/算法/" title="算法">算法</a>,
  
    <a href="/tags/leetcode/" title="leetcode">leetcode</a>
  


      </li>
    </ul>
    <div class="blog-item">
      
	<h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><p>有两个大小为 m 和 n 的排序数组 nums1 和 nums2 。</p>
<p>请找出两个排序数组的中位数并且总的运行时间复杂度为 O(log (m+n)) 。</p>
<p><strong>示例1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">nums1 = [1, 3]</span><br><span class="line">nums2 = [2]</span><br><span class="line"></span><br><span class="line">中位数是 2.0</span><br></pre></td></tr></table></figure>
<p><strong>示例2:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">nums1 = [1, 2]</span><br><span class="line">nums2 = [3, 4]</span><br><span class="line"></span><br><span class="line">中位数是 (2 + 3)/2 = 2.5</span><br></pre></td></tr></table></figure>
<hr>

<p>归并&amp;topK问题</p>
<h2 id="方案1"><a href="#方案1" class="headerlink" title="方案1"></a>方案1</h2><p>这个思路就是对于两个有序数组进行合并，合并到一个大的有序的数组中去，然后求合并后数组的中位数。下面代码中使用的是归并排序的方式，对于两个有序数组进行归并排序的。从复杂度的角度来说可以满足题目的要求，但是还是存在一些问题，主要是怎么能够使得时间复杂度变成O{MIN(nums1.length,nums2.leng)}。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">findMedianSortedArrays</span><span class="params">(<span class="keyword">int</span>[] nums1, <span class="keyword">int</span>[] nums2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">double</span> result = <span class="number">0.0</span>d;</span><br><span class="line">        <span class="keyword">int</span>[] nums = <span class="keyword">new</span> <span class="keyword">int</span>[nums1.length+nums2.length];</span><br><span class="line">        <span class="keyword">int</span> num1index = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> num2index = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> index = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (nums1.length == <span class="number">0</span> &amp;&amp; nums2.length == <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> result;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (nums1.length == <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> getResult(nums2);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (nums2.length == <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> getResult(nums1);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span>(num1index &lt; nums1.length &amp;&amp; num2index &lt; nums2.length)&#123;</span><br><span class="line">            <span class="keyword">if</span> (nums1[num1index] &lt; nums2[num2index])&#123;</span><br><span class="line">                nums[index]= nums1[num1index];</span><br><span class="line">                num1index++;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                nums[index]= nums2[num2index];</span><br><span class="line">                num2index++;</span><br><span class="line">            &#125;</span><br><span class="line">            index++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (num1index &lt; nums1.length)&#123;</span><br><span class="line">            nums[index] = nums1[num1index++];</span><br><span class="line">            index++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span> (num2index &lt; nums2.length)&#123;</span><br><span class="line">            nums[index] = nums2[num2index++];</span><br><span class="line">            index++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (nums.length%<span class="number">2</span>==<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            result = (nums[nums.length/<span class="number">2</span>]+nums[nums.length/<span class="number">2</span>-<span class="number">1</span>])/<span class="number">2.0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            result = nums[nums.length/<span class="number">2</span>];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">double</span> <span class="title">getResult</span><span class="params">(<span class="keyword">int</span>[] nums)</span></span>&#123;</span><br><span class="line">        <span class="keyword">double</span> result = <span class="number">0.0</span>D;</span><br><span class="line">        <span class="keyword">if</span> (nums.length%<span class="number">2</span>==<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            result = (nums[nums.length/<span class="number">2</span>]+nums[nums.length/<span class="number">2</span>-<span class="number">1</span>])/<span class="number">2.0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            result = nums[nums.length/<span class="number">2</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="方案2"><a href="#方案2" class="headerlink" title="方案2"></a>方案2</h2><p><a href="https://www.cnblogs.com/leavescy/p/5877627.html" target="_blank" rel="noopener">求两个排序数组的中位数</a></p>
<ol>
<li>假设nums1.length = m, nums2.length = n; m &lt; n;</li>
<li>若(m + n) % 2 == 0, 表示两数组之和为偶数，应该是有两个中位数，因此最终结果为第9行的代码所示。否则，结果为第7行的代码所示。</li>
<li>为了使得方法的统一，在最初时，对数组进行处理，统一使得传进方法的短数组为nums1，即第14行代码所示。</li>
<li>如果len1-start1 == 0,则表示nums1已经全部加入前k个了，则第k个为nums2[k -1]; 在方法findKth（）中的k是一直变化的，初始时，k为两个数组中排序之后的第k个数的位置；k在方法中的真正含义为“还需要找到多少个数才能达到k个”；因此假设nums1.length ==0;,此时len1-start1 == 0, 则中位数就是nums2[k - 1],即在nums1中找到了0个数，还需要找k个数，第k个数就是nums[k - 1];</li>
<li>如果k == 1,则表示前k-1小的数已经找过了，则第k个数肯定是nums1[start1]和nums2[start2]中较小的那个数。</li>
<li>下面接着就是常规的情况：即nums1中包含一部分k,nums2中也包含一部分的k,因此就从每个数组的k/2那里开始比较（也相当于每次都会有一半的数被加入前k个，因此时间复杂度为O（log(m + n)））：<br>采用p1和p2分别记录当前nums1和nums2需要比较的那个位，由于nums1比较短，因此有可能2/k的位置已经超出了nums1的长度，因此nums1还需要做特殊处理，即第19行代码所示；由于p1做了特殊处理，那p2也就要做特殊处理。总之，start1~p1和start2~p2的和一定为k。<br>1）若nums1[p1 - 1] &lt; nums[p2 - 1],则表明【start1, p1)之间的值在前k个数中；<br>2）若nums[p1 - 1] &gt; nums2[p2- 1],则表明【start2, p2)之间的值在前k个数中；<br>3）若两值相等，则表明【start1, p1)+【start2， p2）的个数为k,则结果直接返回其中一个即可。<br>为什么比较的p1和p2的前一个位的数，而不是p1和p2位置的数呢？ 举例说明：假设start1== start2 == 0, 则p1 = Math.min(len1, k / 2); p2 = k - p1,即p1 + p2 == k;；假设p1 = 5, p2 = 7;, 则k = 12; 在数组中nums[5]其实是第6个数，nums[7]其实是第8个数，所以我们比较的是nums1[p1 - 1]与nums2[p2 - 1]的值；</li>
</ol>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">findMedianSortedArrays</span><span class="params">(<span class="keyword">int</span>[] nums1, <span class="keyword">int</span>[] nums2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> len1 = nums1.length;</span><br><span class="line">        <span class="keyword">int</span> len2 = nums2.length;</span><br><span class="line">        <span class="keyword">int</span> size = len1 + len2;</span><br><span class="line">        <span class="keyword">if</span>(size % <span class="number">2</span> == <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> findKth(nums1, <span class="number">0</span>, len1, nums2, <span class="number">0</span>, len2, size / <span class="number">2</span> + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> (findKth(nums1, <span class="number">0</span>, len1, nums2, <span class="number">0</span>, len2, size / <span class="number">2</span>) + findKth(nums1, <span class="number">0</span>, len1, nums2, <span class="number">0</span>, len2, size / <span class="number">2</span> + <span class="number">1</span>)) /<span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">findKth</span><span class="params">(<span class="keyword">int</span>[] nums1, <span class="keyword">int</span> start1, <span class="keyword">int</span> len1, <span class="keyword">int</span>[] nums2, <span class="keyword">int</span> start2, <span class="keyword">int</span> len2, <span class="keyword">int</span> k)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(len1 - start1 &gt; len2 -start2)  <span class="comment">// 传进来的时候统一让短的数组为nums1</span></span><br><span class="line">            <span class="keyword">return</span> findKth(nums2, start2, len2, nums1, start1, len1, k);</span><br><span class="line">        <span class="keyword">if</span>(len1 - start1 == <span class="number">0</span>)  <span class="comment">// 表示nums1已经全部加入前K个了，第k个为nums2[k - 1];</span></span><br><span class="line">            <span class="keyword">return</span> nums2[k - <span class="number">1</span>];</span><br><span class="line">        <span class="keyword">if</span>(k == <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> Math.min(nums1[start1], nums2[start2]); <span class="comment">// k==1表示已经找到第k-1小的数，下一个数为两个数组start开始的最小值</span></span><br><span class="line">        <span class="keyword">int</span> p1 = start1 + Math.min(len1 - start1, k / <span class="number">2</span>); <span class="comment">// p1和p2记录当前需要比较的那个位</span></span><br><span class="line">        <span class="keyword">int</span> p2 = start2 + k - p1 + start1;</span><br><span class="line">        <span class="keyword">if</span>(nums1[p1 - <span class="number">1</span>] &lt; nums2[p2 - <span class="number">1</span>])</span><br><span class="line">            <span class="keyword">return</span> findKth(nums1,  p1, len1, nums2, start2, len2, k - p1 + start1);</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(nums1[p1 - <span class="number">1</span>] &gt; nums2[p2 -<span class="number">1</span>])</span><br><span class="line">            <span class="keyword">return</span> findKth(nums1, start1, len1, nums2, p2, len2, k - p2 + start2);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> nums1[p1 - <span class="number">1</span>];</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
      
    </div>
    <br>
    <br>
    <a href="http://www.glmapper.com/2018/11/10/leetcode4/" class="more">Read more <i class="icon-angle-right"></i></a>
  </div>
</div>
<hr class="blog-post-sep">

      
	<div class="row">
  <div class="col-md-4 col-sm-4">
    
  </div>
  
    <div class="col-xs-12">
  
    
    <h2 itemprop="name">
      <a class="archive-article-title" href="/2018/11/10/leetcode3/">每天一道算法题：最长回文子串</a>
    </h2>


    <ul class="blog-info">
      <li>
      	<i class="fa fa-calendar"></i> 
        <time datetime="2018-11-10T05:33:24.000Z" itemprop="datePublished">2018/11/10</time>

      </li>
      <li><i class="fa fa-comments"></i>
        <a href="http://www.glmapper.com/2018/11/10/leetcode3/#disqus_thread" class="article-comment-link">Comments</a>
      </li>
      <li>
	<i class="fa fa-tags"></i>
	
  
    <a href="/tags/算法/" title="算法">算法</a>,
  
    <a href="/tags/leetcode/" title="leetcode">leetcode</a>
  


      </li>
    </ul>
    <div class="blog-item">
      
	<p>##题目<br>给定一个字符串 s，找到 s 中最长的回文子串。你可以假设 s 长度最长为1000。</p>
<p><strong>示例:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">输入: &quot;babad&quot;</span><br><span class="line"></span><br><span class="line">输出: &quot;bab&quot;</span><br><span class="line"></span><br><span class="line">注意: &quot;aba&quot;也是有效答案</span><br></pre></td></tr></table></figure>
<p><strong>示例:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">输入: &quot;cbbd&quot;</span><br><span class="line"></span><br><span class="line">输出: &quot;bb&quot;</span><br></pre></td></tr></table></figure>
<h2 id="思路"><a href="#思路" class="headerlink" title="思路"></a>思路</h2><p>一开始是想用最笨的方法来解的，也就是找出所有的字串，然后再对所有的子串进行回文检测，并记录长度。这种方式时间复杂度可想而知，O(n)<em>O(n)</em>O(n)=O(n^3)。所以这种肯定是不能满足我们要求的。</p>
<p>ok，那我们来分析一下这个问题，先把这个问题特殊化；</p>
<ul>
<li><p>假如输入的字符串长度就是1</p>
<p>  那么这个字符串的最长回文串就是它自己，长度就是1</p>
</li>
<li><p>假如字符串长度为2，它要是回文串的化，就需要两个字符是相等的。</p>
<p>  即：s[i] == s[j]  且i-j=1(此处假定i是较大索引位置)</p>
</li>
<li><p>那么对于i－j&gt;1的情况下呢？是不是只要满足下面的条件就可以了：</p>
<p>  即:s[i] == s[j]&amp;&amp;s[i-1] == s[j+1] </p>
</li>
</ul>
<p>其实这种思路就是动态规划。关于动态规划的理论性文字就不码了，有兴趣的小伙伴阔以自行学习。下面就针对这个问题码一下代码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">longestPalindrome</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//  长度为1，返回当前串</span></span><br><span class="line">    <span class="keyword">if</span> (s.length()==<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//长度为2并且两个字符相等则返回</span></span><br><span class="line">    <span class="keyword">if</span> (s.length()==<span class="number">2</span>&amp;&amp;s.charAt(<span class="number">0</span>)==s.charAt(<span class="number">1</span>))&#123;</span><br><span class="line">        <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//用于标记isLongestPalindrome[j][i]即从j到i是否是回文串；</span></span><br><span class="line">    <span class="comment">//如isLongestPalindrome[1][5]＝＝true则表示字符串索引位置从1到5的子串是回文串。</span></span><br><span class="line">    <span class="keyword">boolean</span>[][] isLongestPalindrome = <span class="keyword">new</span> <span class="keyword">boolean</span>[s.length()][s.length()];</span><br><span class="line">    <span class="comment">//最长回文串初始最大为0</span></span><br><span class="line">    <span class="keyword">int</span> maxlen = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//对应的maxlen的开始索引位置</span></span><br><span class="line">    <span class="keyword">int</span> beginIndex = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">//对应的maxlen的结束索引位置</span></span><br><span class="line">    <span class="keyword">int</span> lastIndex = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;s.length();i++)&#123;</span><br><span class="line">        <span class="keyword">int</span> j=i;</span><br><span class="line">        <span class="keyword">while</span>(j&gt;=<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="comment">//满足上述的第三个条件，即当前s.charAt(i)==s.charAt(j)并</span></span><br><span class="line">            <span class="comment">//且s[j＋1到i－1]也是回文串</span></span><br><span class="line">            <span class="keyword">if</span> (s.charAt(i)==s.charAt(j)&amp;&amp;(i-j&lt;<span class="number">2</span>||isLongestPalindrome[j+<span class="number">1</span>][i-<span class="number">1</span>]))&#123;</span><br><span class="line">                isLongestPalindrome[j][i]=<span class="keyword">true</span>;</span><br><span class="line">                <span class="keyword">if</span> (maxlen &lt; i-j+<span class="number">1</span>) &#123;</span><br><span class="line">                    beginIndex = j;</span><br><span class="line">                    lastIndex = i+<span class="number">1</span>;</span><br><span class="line">                    maxlen = i-j+<span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            j--;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> s.substring(beginIndex,lastIndex);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <br>
    <br>
    <a href="http://www.glmapper.com/2018/11/10/leetcode3/" class="more">Read more <i class="icon-angle-right"></i></a>
  </div>
</div>
<hr class="blog-post-sep">

      
	<div class="row">
  <div class="col-md-4 col-sm-4">
    
  </div>
  
    <div class="col-xs-12">
  
    
    <h2 itemprop="name">
      <a class="archive-article-title" href="/2018/11/10/leetcodetwo/">每天一道算法题：Z字形转换</a>
    </h2>


    <ul class="blog-info">
      <li>
      	<i class="fa fa-calendar"></i> 
        <time datetime="2018-11-10T05:32:42.000Z" itemprop="datePublished">2018/11/10</time>

      </li>
      <li><i class="fa fa-comments"></i>
        <a href="http://www.glmapper.com/2018/11/10/leetcodetwo/#disqus_thread" class="article-comment-link">Comments</a>
      </li>
      <li>
	<i class="fa fa-tags"></i>
	
  
    <a href="/tags/算法/" title="算法">算法</a>,
  
    <a href="/tags/leetcode/" title="leetcode">leetcode</a>
  


      </li>
    </ul>
    <div class="blog-item">
      
	<h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><p>将字符串 “PAYPALISHIRING” 以Z字形排列成给定的行数：（下面这样的形状）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">P   A   H   N</span><br><span class="line">A P L S I I G</span><br><span class="line">Y   I   R</span><br></pre></td></tr></table></figure>
<p>之后按逐行顺序依次排列：”PAHNAPLSIIGYIR”</p>
<p>实现一个将字符串进行指定行数的转换的函数:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">string convert(string text, int nRows);</span><br></pre></td></tr></table></figure>
<p>convert(“PAYPALISHIRING”, 3) 应当返回 “PAHNAPLSIIGYIR” 。</p>
<h2 id="方案"><a href="#方案" class="headerlink" title="方案"></a>方案</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">convert</span><span class="params">(String s, <span class="keyword">int</span> numRows)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//计算字符串长度</span></span><br><span class="line">    <span class="keyword">int</span> len = s.length();</span><br><span class="line">    <span class="comment">//两个周期之间的列数，</span></span><br><span class="line">    <span class="keyword">int</span> slash = numRows - <span class="number">2</span>;</span><br><span class="line">    <span class="comment">//计算行的长度</span></span><br><span class="line">    <span class="keyword">int</span> rowLength = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(len &gt; <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="comment">//竖列</span></span><br><span class="line">        len = len - numRows;</span><br><span class="line">        rowLength++;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//斜着的一列</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; slash &amp;&amp; len &gt; <span class="number">0</span>; i++)&#123;</span><br><span class="line">            len--;</span><br><span class="line">            rowLength++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//建立一个多一列的数组用于保存我们的字符串,并且全部初始化为空格了</span></span><br><span class="line">    <span class="keyword">char</span> result[] = <span class="keyword">new</span> <span class="keyword">char</span>[numRows* rowLength];</span><br><span class="line">    <span class="comment">// 初始化为空格</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; result.length; i++) &#123; </span><br><span class="line">        result[i] = <span class="string">' '</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 当前处理的行数</span></span><br><span class="line">    <span class="keyword">int</span> curColumn = <span class="number">0</span>; </span><br><span class="line">    <span class="keyword">int</span> index = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 下面将字符串写入所谓的矩阵中</span></span><br><span class="line">    <span class="keyword">while</span>(index &lt; s.length())&#123;</span><br><span class="line">        <span class="comment">//写入列</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; numRows &amp;&amp; index &lt; s.length(); i++)&#123;</span><br><span class="line">            result[rowLength * i + curColumn] = s.charAt(index);</span><br><span class="line">            index++;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        curColumn++;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//写入斜线</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = numRows - <span class="number">2</span>; i &gt; <span class="number">0</span> &amp;&amp; index &lt; s.length(); i--)&#123;</span><br><span class="line">            result[rowLength * i + curColumn] = s.charAt(index);</span><br><span class="line">            curColumn++;</span><br><span class="line">            index++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 去空格，定义两个指针循环进行操作</span></span><br><span class="line">    index = <span class="number">0</span>;</span><br><span class="line">    <span class="comment">// 找第一个是空格的字符位置</span></span><br><span class="line">    <span class="keyword">while</span> (index &lt; s.length() &amp;&amp; result[index] != <span class="string">' '</span>) &#123; </span><br><span class="line">        index++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> next = index + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (index &lt; s.length()) &#123;</span><br><span class="line">        <span class="comment">// 找不是空格的元素</span></span><br><span class="line">        <span class="keyword">while</span> (next &lt; result.length &amp;&amp; result[next] == <span class="string">' '</span>) &#123; </span><br><span class="line">            next++;</span><br><span class="line">        &#125;</span><br><span class="line">        result[index] = result[next];</span><br><span class="line">        index++;</span><br><span class="line">        next++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> String(result, <span class="number">0</span>, index);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个题目想了两天，之前的思路是建立一个二维数组，然后填充，最后遍历数组拿到结果，但是对于很多边界问题不太好考虑，放弃。这两种方案的首要核心都是计算列数和对斜列的处理，没有数学功底和抽象思维的程序员真的伤不起。</p>

      
    </div>
    <br>
    <br>
    <a href="http://www.glmapper.com/2018/11/10/leetcodetwo/" class="more">Read more <i class="icon-angle-right"></i></a>
  </div>
</div>
<hr class="blog-post-sep">

      
	<div class="row">
  <div class="col-md-4 col-sm-4">
    
  </div>
  
    <div class="col-xs-12">
  
    
    <h2 itemprop="name">
      <a class="archive-article-title" href="/2018/11/10/leetcodeone/">每天一道算法题：颠倒整数</a>
    </h2>


    <ul class="blog-info">
      <li>
      	<i class="fa fa-calendar"></i> 
        <time datetime="2018-11-10T05:31:19.000Z" itemprop="datePublished">2018/11/10</time>

      </li>
      <li><i class="fa fa-comments"></i>
        <a href="http://www.glmapper.com/2018/11/10/leetcodeone/#disqus_thread" class="article-comment-link">Comments</a>
      </li>
      <li>
	<i class="fa fa-tags"></i>
	
  
    <a href="/tags/算法/" title="算法">算法</a>,
  
    <a href="/tags/leetcode/" title="leetcode">leetcode</a>
  


      </li>
    </ul>
    <div class="blog-item">
      
	<h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><p>给定一个范围为 32 位 int 的整数，将其颠倒。</p>
<p><strong>例 1:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入: 123</span><br><span class="line">输出:  321</span><br></pre></td></tr></table></figure>
<p><strong>例 2:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入: -123</span><br><span class="line">输出: -321</span><br></pre></td></tr></table></figure>
<p><strong>例 3:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">输入: 120</span><br><span class="line">输出: 21</span><br></pre></td></tr></table></figure>
<p>注意:<br>假设我们的环境只能处理 32 位 int范围内的整数。根据这个假设，<br>如果颠倒后的结果超过这个范围，则返回 0。</p>
<h2 id="方案"><a href="#方案" class="headerlink" title="方案"></a>方案</h2><p>这个题目其实挺简单的；思路如下：</p>
<ul>
<li>判断输入的数字是否大于最大整数，其实这里没有必要判断，因为如果参数输入大于最大整数的话会直接报错。</li>
<li>将整数转换成字符串</li>
<li>判断是否是负数，这个依据就是判断字符串中是否存在‘－’</li>
<li>从后向前开始遍历，注意的是必须后向遍历且初始为0的情况下保持继续向前迭代。</li>
<li>如果转换之后的值大于最大整数，则会导致string转int失败，抛出异常，那么我们直接在这把异常捕获，并且返回0（偷懒一波，丷）<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">reverse</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> result = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (x &gt;Integer.MAX_VALUE)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span> ;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    String s =String.valueOf(x);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> len = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (s!=<span class="keyword">null</span>&amp;&amp;s.length()!=<span class="number">0</span>&amp;&amp;s.charAt(<span class="number">0</span>)==<span class="string">'-'</span>)&#123;</span><br><span class="line">        len = <span class="number">1</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(s.length() == <span class="number">1</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> lastp = s.length()-<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">boolean</span> isStart = <span class="keyword">true</span>;</span><br><span class="line">    String ints = <span class="string">""</span>;</span><br><span class="line">    <span class="keyword">while</span>( lastp &gt;= len)&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (isStart &amp;&amp; s.charAt(lastp)==<span class="string">'0'</span>)&#123;</span><br><span class="line">            <span class="keyword">while</span> (s.charAt(lastp)==<span class="string">'0'</span>)&#123;</span><br><span class="line">                lastp--;</span><br><span class="line">            &#125;</span><br><span class="line">            isStart = <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (isStart)&#123;</span><br><span class="line">            isStart = <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        ints = ints+s.charAt(lastp);</span><br><span class="line">        lastp--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        result = Integer.parseInt(ints);</span><br><span class="line">    &#125;<span class="keyword">catch</span> (NumberFormatException e)&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> len==<span class="number">0</span>?result:result*(-<span class="number">1</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
</ul>

      
    </div>
    <br>
    <br>
    <a href="http://www.glmapper.com/2018/11/10/leetcodeone/" class="more">Read more <i class="icon-angle-right"></i></a>
  </div>
</div>
<hr class="blog-post-sep">

      
	<div class="row">
  <div class="col-md-4 col-sm-4">
    
  </div>
  
    <div class="col-xs-12">
  
    
    <h2 itemprop="name">
      <a class="archive-article-title" href="/2018/11/10/seiri-rpc/">关于 rpc 的整理和理解</a>
    </h2>


    <ul class="blog-info">
      <li>
      	<i class="fa fa-calendar"></i> 
        <time datetime="2018-11-10T05:28:43.000Z" itemprop="datePublished">2018/11/10</time>

      </li>
      <li><i class="fa fa-comments"></i>
        <a href="http://www.glmapper.com/2018/11/10/seiri-rpc/#disqus_thread" class="article-comment-link">Comments</a>
      </li>
      <li>
	<i class="fa fa-tags"></i>
	
  
    <a href="/tags/rpc/" title="rpc">rpc</a>,
  
    <a href="/tags/dubbo/" title="dubbo">dubbo</a>,
  
    <a href="/tags/微服务/" title="微服务">微服务</a>
  


      </li>
    </ul>
    <div class="blog-item">
      
	<h1 id="架构演变"><a href="#架构演变" class="headerlink" title="架构演变"></a>架构演变</h1><ul>
<li><p>所有的界面和服务均在同一个进程下<br><img src="https://user-gold-cdn.xitu.io/2018/3/11/1621576f8c29c490?w=730&amp;h=625&amp;f=png&amp;s=55992" alt=""></p>
</li>
<li><p>基于mvc的视图与服务分离，但是实际上还是在一个应用系统中，只不过在功能层次上划分的更加细致<br><img src="https://user-gold-cdn.xitu.io/2018/3/11/16215773671e27af?w=725&amp;h=607&amp;f=png&amp;s=55638" alt=""></p>
</li>
<li><p>粒度更细，对于不同的功能服务进行切分，并进行单独的部署<br><img src="https://user-gold-cdn.xitu.io/2018/3/11/1621577911209db2?w=752&amp;h=605&amp;f=png&amp;s=67938" alt=""></p>
</li>
<li><p>面向服务的架构，将应用程序的不同功能单元（称为服务）通过这些服务之间定义良好的接口和契约联系起来<br><img src="https://user-gold-cdn.xitu.io/2018/3/11/1621577ae54199ff?w=784&amp;h=622&amp;f=png&amp;s=66194" alt=""></p>
</li>
<li><p>微服务</p>
<p>  此处不支持图片展示，自行脑补！！！</p>
</li>
</ul>
<p>随着业务量和用户量的增加，架构也是从单一系统走向分布式系统，我能想到的是，这种架构的演变主要解决的问题在于：</p>
<ul>
<li>通过业务模块的拆分，使得每个模块的职责更加清晰，但是模块的职责边界的划分往往也是很疼头的事情。</li>
<li>细致的划分使得项目在管理上面会更加方面，从代码的角度来说，开发和维护的成本也会降低，不会因为一个bug去跑整个项目了。</li>
<li>提高了系统的容错率，单一系统如果宕机那就真的gg了，另外就是，单个环节出现问题也会导致项目无法正常运行（比如数据库出问题了）。对于分布式系统来说，一般都会使用冗余的方式来提高可用性，个人理解就是可以提供多个一样的服务，它们之间可以进行切换。</li>
<li>分布式系统带来的问题一个是成本，硬件成本，运维成本都会增加。</li>
</ul>
<h1 id="rpc简介及常用的rpc框架"><a href="#rpc简介及常用的rpc框架" class="headerlink" title="rpc简介及常用的rpc框架"></a>rpc简介及常用的rpc框架</h1><p>随着集中式架构向分布式架构的转变，应用系统之间的服务调用与通讯问题成为了首要解决的需求。</p>
<p><strong>而RPC 的主要目标就是为了让构建分布式计算（应用）变得更加简单，在提供强大的远程调用能力时不损失本地调用的语义简洁性。 为实现该目标，RPC 框架需提供一种透明调用机制让使用者不必显式的区分本地调用和远程调用。</strong></p>
<p>如下代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">   @Autowired</span><br><span class="line">private GlRpcAgent glRpcAgent; //rpc代理</span><br><span class="line">/**</span><br><span class="line"> * @param param 此处约定参数以Map键值对的形式传递</span><br><span class="line"> */</span><br><span class="line">@Override</span><br><span class="line">public List&lt;OrderInfo&gt; queryOrdersByUserId(Map&lt;String, Object&gt; param) &#123;</span><br><span class="line">	//创建远程调用代理（远程服务的类的全限定名）</span><br><span class="line">	OrderConsumeAgent orderConsumer=glRpcAgent.getAgent(&quot;com.glmapper.rpc.interface.OrderConsumeInterface&quot;);</span><br><span class="line">	//通过代理获取返回结果  此处getOrders为远程服务器上的com.glmapper.rpc.interface.OrderConsumeInterface接口中的方法，param为参数</span><br><span class="line">	Map&lt;String,Object&gt; resultMap=(Map)orderConsumer.call(&quot;getOrders&quot;,param);</span><br><span class="line">	//解析返回结果（远程方法同样以Map集合的方式放回）</span><br><span class="line">	List&lt;OrderInfo&gt; orders = parseResultMap(resultMap);</span><br><span class="line">	return orders;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>为什么要以全限定名来获取呢，这个我们将会在后面来说。</p>
<h2 id="什么是RPC"><a href="#什么是RPC" class="headerlink" title="什么是RPC"></a>什么是RPC</h2><p>In distributed computing a remote procedure call (RPC) is when a computer program causes a procedure (subroutine) to execute in another address space(commonly on another computer on a shared network), which is coded as if it were a normal (local) procedure call, without the programmer explicitly coding the details for the remote interaction.<br>RPC 的全称是 Remote Procedure Call 是一种<strong>进程间通信</strong>方式。 它允许程序调用另一个进程上（通常是共享网络的另一台机器上）的过程或函数，而<strong>不用程序员显式编码这个远程调用的细节</strong>。即程序员<strong>无论是调用本地的还是远程的函数，本质上编写的调用代码基本相同</strong>。</p>
<p>从定义中可以得知，RPC主要来解决三件事情：</p>
<ul>
<li>进程间通讯</li>
<li>提供和本地方法调用一样的调用机制</li>
<li>屏蔽程序员对远程调用的细节实现</li>
</ul>
<p>首先是进程间的通信问题，对于分布式环境，rpc能够帮助我们解决不同服务器之间的通信及数据传输问题，即<strong>做好方法调用到数据的转换，然后借助网络进行数据传递；</strong>rpc客户端向rpc服务端发起远程服务调用，通过请求的封装，参数的封装，序列化、编码、约定协议传输、解析请求、处理请求、封装返回消息数据、在进行返回数据的序列化、编码、在通过网络返回给客户端。再者是提供和本地方法调用一样的调用机制，为什么这么说，对于业务系统来说，我们更多的关注点在于如何解决实际的业务需求问题，而不想花更多的时间和心思在诸如上述过程中关于网络传输及编解码过程，因此对于rpc来说，需要将这些编解码、协议约定、网络传输等进行一个整体的封装，然后只向业务系统提供最简单的调用方式。最后一个屏蔽程序员对远程调用的细节实现，其实也就是第二点中提到的那些功能的封装，我们不用去关系rpc到底是如何实现的，也不用关心它是如何运作的，对于业务开发人员来说，通过约定的方式进行类似于本地方法调用的形式来调用远程服务接口就可以了。<br><strong>那么如何实现透明化的远程调用呢？</strong><br><strong>什么样的内部封装才能让我们觉得像以本地调用方式调用远程服务呢？</strong><br>对于java来说就是使用代理。java代理有两种方式：1） jdk 动态代理（接口代理）；2）cglib代理（子类代理）。尽管字节码生成方式实现的代理更为强大和高效，但代码不易维护，大部分公司实现RPC框架时还是选择动态代理方式。这部分也将会在后续的章节中展开来说。</p>
<h2 id="RPC基本原理"><a href="#RPC基本原理" class="headerlink" title="RPC基本原理"></a>RPC基本原理</h2><p>上面说到，rpc需要对一些远程调用的内部实现进行封装。我们说到有以下几个点：</p>
<ul>
<li>序列化</li>
<li>编解码</li>
<li>协议</li>
<li>网络</li>
</ul>
<p>从发起远程调用到接收到数据返回结果，大致过程是：</p>
<p>1）服务消费方（client）调用以本地调用方式调用服务；<br>2）client stub接收到调用后负责将方法、参数等组装成能够进行网络传输的消息体；<br>3）client stub找到服务地址，并将消息发送到服务端；<br>4）server stub收到消息后进行解码；<br>5）server stub根据解码结果调用本地的服务；<br>6）本地服务执行并将结果返回给server stub；<br>7）server stub将返回结果打包成消息并发送至消费方；<br>8）client stub接收到消息，并进行解码；<br>9）服务消费方得到最终结果。</p>
<p>那么rpc就相当于将step2-step8的步骤进行了封装。下面借用一张网上的图片来帮助我们理解这个过程。</p>
<p><img src="https://user-gold-cdn.xitu.io/2017/11/23/15fe93fb307ec7e9?w=554&amp;h=323&amp;f=png&amp;s=171659" alt=""></p>
<h2 id="RPC模型"><a href="#RPC模型" class="headerlink" title="RPC模型"></a>RPC模型</h2><p>对于上图，我们进行进一步的拆解得到（来自网络）：</p>
<p><img src="https://user-gold-cdn.xitu.io/2017/11/23/15fe94c7fd4edb39?w=841&amp;h=404&amp;f=png&amp;s=205212" alt=""><br>RPC 服务端通过 RpcServer 去暴露服务接口，而客户端通过 RpcClient 去获取服务接口。客户端像调用本地方法一样去调用远程接口方法，RPC 框架提供接口的代理实现，实际的调用将委托给代理 RpcProxy。代理封装调用信息并将调用转交给 RpcInvoker 去实际执行。在客户端的 RpcInvoker 通过连接器 RpcConnector 去维持与服务端的通道 RpcChannel，并使用 RpcProtocol 执行协议编码（encode）并将编码后的请求消息通过通道发送给服务端。RPC 服务端接收器 RpcAcceptor接收客户端的调用请求，同样使用 RpcProtocol 执行协议解码（decode）。<br>解码后的调用信息传递给 RpcProcessor 去控制处理调用过程，最后再委托调用给 RpcInvoker 去实际执行并返回调用结果。</p>
<p>通过上述分析可知，这里面包括以下核心组件：</p>
<ul>
<li>用于暴露服务接口的RpcServer </li>
<li>用于发现服务接口的RpcClient </li>
<li>远程接口的代理实现RpcProxy </li>
<li>负责协议编解码的RpcProtocol（实际的rpc框架中一般会提供多种不同的实现）</li>
<li>网络连接器<br>（之前看过一篇文章说9个组件，对于咱们这个来说，部分模块可以集成在client和server中）</li>
</ul>
<h2 id="常见的RPC框架"><a href="#常见的RPC框架" class="headerlink" title="常见的RPC框架"></a>常见的RPC框架</h2><p>目前常见的分布式RPC框架有以下几个：</p>
<ul>
<li>dubbo<br>阿里巴巴公司开源的一个Java高性能优秀的服务框架，使得应用可通过高性能的 RPC 实现服务的输出和输入功能，可以和 Spring框架无缝集成</li>
<li>motan<br>新浪微博开源的一个Java 框架。它诞生的比较晚，起于2013年，2016年5月开源。Motan 在微博平台中已经广泛应用，每天为数百个服务完成近千亿次的调用。</li>
<li>rpcx<br>Go语言生态圈的Dubbo， 比Dubbo更轻量，实现了Dubbo的许多特性，借助于Go语言优秀的并发特性和简洁语法，可以使用较少的代码实现分布式的RPC服务。</li>
<li>gRPC<br>Google开发的高性能、通用的开源RPC框架，主要面向移动应用开发并基于HTTP/2协议标准而设计，基于ProtoBuf(Protocol Buffers)序列化协议开发，且支持众多开发语言。本身它不是分布式的，所以要实现上面的框架的功能需要进一步的开发。</li>
<li>thrift<br>Apache的一个跨语言的高性能的服务框架</li>
</ul>
<h2 id="RPC与MQ"><a href="#RPC与MQ" class="headerlink" title="RPC与MQ"></a>RPC与MQ</h2><p>MQ(message queue)消息队列，从某种程度上来说，同样可以实现RPC的功能。从功能特点上来说，MQ可以把消息存储，而RPC不行。关于MQ和RPC做了以下简单的对比，如下图所示：</p>
<p><img src="https://user-gold-cdn.xitu.io/2017/11/23/15fe963722bccc10?w=572&amp;h=318&amp;f=png&amp;s=100343" alt=""></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>本文对RPC的基本原理、特点以及基本组件进行了简单的说明，让我们可以对RPC有一个基本的了解。关于常见的RPC框架也做了基本认识，对于这些优秀的框架，我们在实现我们自己RPC时可以借鉴一下这些架构里的一些模式以及技术。最后说明了下为什么我们会在分布式架构中要使用RPC而不是MQ，对于MQ来说，在处理同步调用无法满足实际的生产需求，而RPC才更加适合分布式应用的实际需要。</p>

      
    </div>
    <br>
    <br>
    <a href="http://www.glmapper.com/2018/11/10/seiri-rpc/" class="more">Read more <i class="icon-angle-right"></i></a>
  </div>
</div>
<hr class="blog-post-sep">

      
	<div class="row">
  <div class="col-md-4 col-sm-4">
    
  </div>
  
    <div class="col-xs-12">
  
    
    <h2 itemprop="name">
      <a class="archive-article-title" href="/2018/11/10/seiri-mybatis/">关于 Mybatis 中 SQL 语句的整理</a>
    </h2>


    <ul class="blog-info">
      <li>
      	<i class="fa fa-calendar"></i> 
        <time datetime="2018-11-10T05:26:49.000Z" itemprop="datePublished">2018/11/10</time>

      </li>
      <li><i class="fa fa-comments"></i>
        <a href="http://www.glmapper.com/2018/11/10/seiri-mybatis/#disqus_thread" class="article-comment-link">Comments</a>
      </li>
      <li>
	<i class="fa fa-tags"></i>
	
  
    <a href="/tags/mybatis/" title="mybatis">mybatis</a>,
  
    <a href="/tags/sql/" title="sql">sql</a>,
  
    <a href="/tags/数据库/" title="数据库">数据库</a>
  


      </li>
    </ul>
    <div class="blog-item">
      
	<blockquote>
<p>随着业务的发展，越来越多的应用系统都从一个大的系统分拆成多个小的系统，各个系统之间通过一定的通信协议进行数据交换。这样就会导致一些小的应用系统自己不用去进行数据库的操作，只需要进行一些rpc调用或者缓存就可以拿到数据进行展示。我之前参与的一个项目就是这样的情况，而我也是将近7个多月的时间没有写过一行SQL。</p>
</blockquote>
<p>近期参与的一个项目的数据大多都市基于数据库来进行数据交互的，所以免不了的要写大量的SQL，所以本篇就总结一下一些SQL的基本写法，以备后用。</p>
<h2 id="建表"><a href="#建表" class="headerlink" title="建表"></a>建表</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">IF</span> <span class="keyword">NOT</span> <span class="keyword">EXISTS</span> <span class="string">`user_test`</span> (</span><br><span class="line">  <span class="string">`id`</span> <span class="built_in">int</span>(<span class="number">11</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> AUTO_INCREMENT <span class="keyword">COMMENT</span> <span class="string">'自增长id'</span>,</span><br><span class="line">  <span class="string">`user_name`</span> <span class="built_in">varchar</span>(<span class="number">128</span>) <span class="keyword">NOT</span> <span class="literal">NULL</span> <span class="keyword">COMMENT</span> <span class="string">'用户名'</span>,</span><br><span class="line">   PRIMARY <span class="keyword">KEY</span> (<span class="string">`id`</span>)</span><br><span class="line">) <span class="keyword">ENGINE</span>=<span class="keyword">InnoDB</span> <span class="keyword">DEFAULT</span> <span class="keyword">CHARSET</span>=utf8mb4 <span class="keyword">COMMENT</span>=<span class="string">'用户表'</span>;</span><br></pre></td></tr></table></figure>
<h2 id="查询"><a href="#查询" class="headerlink" title="查询"></a>查询</h2><ul>
<li>简单的查询</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryUserByName"</span> <span class="attr">resultMap</span>=<span class="string">"userMap"</span> <span class="attr">parameterType</span>=<span class="string">"java.lang.String"</span>&gt;</span></span><br><span class="line">	SELECT * FROM user_test WHERE user_name = #&#123;userName&#125;</span><br><span class="line"> <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>需要注意的是如果这里不指定parameterType，则默认会识别处理；如果指定了类型，则传入的值就需要和当前指定的类型保持一致，不然就会出现数据类型转换异常。</p>
<ul>
<li>简单分页查询</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"queryUsersList"</span> <span class="attr">resultMap</span>=<span class="string">"userMap"</span>&gt;</span></span><br><span class="line">    SELECT * FROM user_test WHERE 1=1 </span><br><span class="line">        <span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"keyword != null and keyword != ''"</span> &gt;</span></span><br><span class="line">            AND user_name LIKE concat('%',#&#123;keyword&#125;,'%')</span><br><span class="line">        <span class="tag">&lt;/<span class="name">if</span>&gt;</span></span><br><span class="line">    LIMIT #&#123;currentPage&#125;,#&#123;pageSize&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>left join</li>
</ul>
<p>app_info表和app_verion表分别存储的是应用信息和应用版本信息。现在要根据appId和versionId查出一个应用的具体信息【包括信息信息和版本信息】</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=&quot;getAppDetail&quot; resultMap=&quot;appDeatilMap&quot;&gt;</span><br><span class="line">    	select  m.id id,</span><br><span class="line">		m.app_name appName,</span><br><span class="line">		n.version version,</span><br><span class="line">		from app_info m</span><br><span class="line">		LEFT JOIN app_version n ON m.id = n.app_id </span><br><span class="line">		where m.id = #&#123;appId&#125; and n.id = #&#123;versionId&#125;</span><br><span class="line">    &lt;/select&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li>查询条件是list</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=&quot;queryAppByAppNames&quot; resultMap=&quot;AppMap&quot; parameterType=&quot;java.util.List&quot;&gt;</span><br><span class="line">	select </span><br><span class="line">		a.app_name appName,</span><br><span class="line">		b.version version</span><br><span class="line">	from starter_info a,starter_version b </span><br><span class="line">	where </span><br><span class="line">		a.id = b.app_id </span><br><span class="line">		and a.id in </span><br><span class="line">		(</span><br><span class="line">        		select id from app_info where app_name in </span><br><span class="line">        		&lt;foreach collection=&quot;list&quot; item=&quot;item&quot; index=&quot;index&quot; open=&quot;(&quot; close=&quot;)&quot; separator=&quot;,&quot;&gt;</span><br><span class="line">        			#&#123;item&#125;</span><br><span class="line">        		&lt;/foreach&gt;</span><br><span class="line">		)</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure>
<h2 id="更新"><a href="#更新" class="headerlink" title="更新"></a>更新</h2><ul>
<li>简单的更新</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateApp"</span> <span class="attr">parameterType</span>=<span class="string">"java.util.List"</span>&gt;</span></span><br><span class="line">    UPDATE app_info</span><br><span class="line">        SET </span><br><span class="line">            app_name = #&#123;appName&#125;</span><br><span class="line">        WHERE </span><br><span class="line">            app_id = #&#123;appId&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>批量更新</li>
</ul>
<p>有这样一个需求，把 app_info表中id 为1，2，3的app的app_name改为appName1，appName2，appName3;</p>
<p>使用 case ..when ..then 这样的语法结构来完成：</p>
<p>case 是当前的条件，when表示条件值，then后面是当前目前更新字段的值；</p>
<blockquote>
<p>下面的说明：当前id=#{item.appId}时,app_name=#{item.appName}</p>
</blockquote>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateApps"</span> <span class="attr">parameterType</span>=<span class="string">"java.util.List"</span>&gt;</span></span><br><span class="line">	UPDATE app_info set app_name =</span><br><span class="line">	<span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">"applList"</span> <span class="attr">item</span>=<span class="string">"item"</span> <span class="attr">index</span>=<span class="string">"index"</span> <span class="attr">separator</span>=<span class="string">" "</span> <span class="attr">open</span>=<span class="string">"case ID"</span> <span class="attr">close</span>=<span class="string">"end"</span>&gt;</span></span><br><span class="line">		when #&#123;item.appId,jdbcType=INTEGER&#125; then #&#123;item.appName,jdbcType=INTEGER&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line">	</span><br><span class="line">	where id in</span><br><span class="line">	<span class="tag">&lt;<span class="name">foreach</span> <span class="attr">collection</span>=<span class="string">"appList"</span> <span class="attr">index</span>=<span class="string">"index"</span> <span class="attr">item</span>=<span class="string">"item"</span> <span class="attr">separator</span>=<span class="string">","</span> <span class="attr">open</span>=<span class="string">"("</span> <span class="attr">close</span>=<span class="string">")"</span>&gt;</span></span><br><span class="line">		#&#123;item.appId,jdbcType=INTEGER&#125;</span><br><span class="line">	<span class="tag">&lt;/<span class="name">foreach</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>OK，现在于这样的需要：</p>
<p>根据应用类型的不同，更新不同的运行环境配置；</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    [</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;appType&quot;:&quot;applet&quot;,</span><br><span class="line">            &quot;cpu&quot;:5,</span><br><span class="line">            &quot;memory&quot;:4,</span><br><span class="line">            &quot;card&quot;:3,</span><br><span class="line">            &quot;nums&quot;:2,</span><br><span class="line">            &quot;network&quot;:1,</span><br><span class="line">            &quot;isInUse&quot;:1</span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;appType&quot;:&quot;bs&quot;,</span><br><span class="line">            &quot;cpu&quot;:5,</span><br><span class="line">            &quot;memory&quot;:4,</span><br><span class="line">            &quot;card&quot;:3,</span><br><span class="line">            &quot;nums&quot;:2,</span><br><span class="line">            &quot;network&quot;:1,</span><br><span class="line">            &quot;isInUse&quot;:1</span><br><span class="line"></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            &quot;appType&quot;:&quot;cs&quot;,</span><br><span class="line">            &quot;cpu&quot;:5,</span><br><span class="line">            &quot;memory&quot;:4,</span><br><span class="line">            &quot;card&quot;:3,</span><br><span class="line">            &quot;nums&quot;:2,</span><br><span class="line">            &quot;network&quot;:1,</span><br><span class="line">            &quot;isInUse&quot;:1</span><br><span class="line">        &#125;,</span><br><span class="line">        //有几个放几个</span><br><span class="line">    ]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>trim属性说明 </p>
<ul>
<li>1.prefix,suffix 表示在trim标签包裹的部分的前面或者后面添加内容 </li>
<li>2.如果同时有prefixOverrides,suffixOverrides 表示会用prefix,suffix覆盖Overrides中的内容。 </li>
<li>3.如果只有prefixOverrides,suffixOverrides 表示删除开头的或结尾的xxxOverides指定的内容。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line">&lt;update id=&quot;updateBatchApp&quot; parameterType=&quot;java.util.List&quot;&gt;</span><br><span class="line">	UPDATE app_info</span><br><span class="line">	&lt;trim prefix=&quot;set&quot; suffixOverrides=&quot;,&quot;&gt;</span><br><span class="line">		&lt;trim prefix=&quot;cpu = case&quot; suffix=&quot;end,&quot;&gt;</span><br><span class="line">			&lt;foreach collection=&quot;modelList&quot; item=&quot;item&quot; index=&quot;index&quot;&gt;</span><br><span class="line">				&lt;if test=&quot;item != null&quot;&gt;</span><br><span class="line">					when app_type =#&#123;item.appType&#125; then #&#123;item.cpu&#125;</span><br><span class="line">				&lt;/if&gt;</span><br><span class="line">			&lt;/foreach&gt;</span><br><span class="line">		&lt;/trim&gt;</span><br><span class="line">		&lt;trim prefix=&quot;memory = case&quot; suffix=&quot;end,&quot;&gt;</span><br><span class="line">			&lt;foreach collection=&quot;modelList&quot; item=&quot;item&quot; index=&quot;index&quot;&gt;</span><br><span class="line">				&lt;if test=&quot;item != null&quot;&gt;</span><br><span class="line">					when app_type =#&#123;item.appType&#125; then #&#123;item.memory&#125;</span><br><span class="line">				&lt;/if&gt;</span><br><span class="line">			&lt;/foreach&gt;</span><br><span class="line">		&lt;/trim&gt;</span><br><span class="line">		&lt;trim prefix=&quot;card = case&quot; suffix=&quot;end,&quot;&gt;</span><br><span class="line">			&lt;foreach collection=&quot;modelList&quot; item=&quot;item&quot; index=&quot;index&quot;&gt;</span><br><span class="line">				when app_type =#&#123;item.appType&#125; then #&#123;item.card&#125;</span><br><span class="line">			&lt;/foreach&gt;</span><br><span class="line">		&lt;/trim&gt;</span><br><span class="line">		&lt;trim prefix=&quot;nums = case&quot; suffix=&quot;end,&quot;&gt;</span><br><span class="line">			&lt;foreach collection=&quot;modelList&quot; item=&quot;item&quot; index=&quot;index&quot;&gt;</span><br><span class="line">				when app_type =#&#123;item.appType&#125; then #&#123;item.nums&#125;</span><br><span class="line">			&lt;/foreach&gt;</span><br><span class="line">		&lt;/trim&gt;</span><br><span class="line">		&lt;trim prefix=&quot;network = case&quot; suffix=&quot;end,&quot;&gt;</span><br><span class="line">			&lt;foreach collection=&quot;modelList&quot; item=&quot;item&quot; index=&quot;index&quot;&gt;</span><br><span class="line">				when app_type =#&#123;item.appType&#125; then #&#123;item.network&#125;</span><br><span class="line">			&lt;/foreach&gt;</span><br><span class="line">		&lt;/trim&gt;</span><br><span class="line">		&lt;trim prefix=&quot;is_in_use = case&quot; suffix=&quot;end,&quot;&gt;</span><br><span class="line">			&lt;foreach collection=&quot;modelList&quot; item=&quot;item&quot; index=&quot;index&quot;&gt;</span><br><span class="line">				when app_type =#&#123;item.appType&#125; then #&#123;item.isInUse&#125;</span><br><span class="line">			&lt;/foreach&gt;</span><br><span class="line">		&lt;/trim&gt;</span><br><span class="line">	&lt;/trim&gt;</span><br><span class="line">	where app_id = #&#123;appId&#125;</span><br><span class="line">&lt;/update&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>关于性能问题没做研究，之前看过关于不同更新语句写法的一篇性能的分析，大家有兴趣可以看下：<a href="https://blog.csdn.net/xu1916659422/article/details/77971696" target="_blank" rel="noopener">批量更新数据两种方法效率对比</a></p>
</blockquote>
<h2 id="删除"><a href="#删除" class="headerlink" title="删除"></a>删除</h2><ul>
<li>简单删除</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DELETE FROM app_info where id = #&#123;id&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>批量删除</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;delete id=&quot;deleteApps&quot; parameterType=&quot;java.util.List&quot;&gt;</span><br><span class="line">	DELETE FROM app_info where  app_id in </span><br><span class="line">    	&lt;foreach item=&quot;item&quot; collection=&quot;appIds&quot; open=&quot;(&quot; separator=&quot;,&quot; close=&quot;)&quot;&gt;</span><br><span class="line">            #&#123;item&#125;</span><br><span class="line">        &lt;/foreach&gt;</span><br><span class="line">&lt;/delete&gt;</span><br></pre></td></tr></table></figure>
<h2 id="时间字符串-order-by"><a href="#时间字符串-order-by" class="headerlink" title="时间字符串 order by"></a>时间字符串 order by</h2><p>不知道各位是否遇到过，之前的前辈们在项目中将时间用字符串的方式存在DB中，而不是使用DATE,然后有一天你的前辈走了，你的主管说查出来按时间来排序….；呵呵，好！！！</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=&quot;querySysParamList&quot; resultMap=&quot;sysParamDO&quot;&gt;</span><br><span class="line">    SELECT * FROM app_info WHERE 1=1</span><br><span class="line">        &lt;if test=&quot;keyword != null and keyword != &apos;&apos;&quot; &gt;</span><br><span class="line">            AND app_name LIKE concat(&apos;%&apos;,#&#123;keyword&#125;,&apos;%&apos;)</span><br><span class="line">        &lt;/if&gt;</span><br><span class="line">    ORDER BY DATE_FORMAT(update_time,&apos;%H %k %I %r %T %S %w&apos;) DESC</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>字符串转为日期格式<br>SELECT DATE_FORMAT(‘2011-09-20 08:30:45’,   ‘%Y-%m-%d %H:%i:%S’);</p>
</blockquote>
<blockquote>
<p>把日期转为字符串格式<br>SELECT DATE_FORMAT(NOW(),   ‘%Y-%m-%d %H:%i:%S’);</p>
</blockquote>
<p>附：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">%M 月名字(January……December) </span><br><span class="line">%W 星期名字(Sunday……Saturday) </span><br><span class="line">%D 有英语前缀的月份的日期(1st, 2nd, 3rd, 等等。） </span><br><span class="line">%Y 年, 数字, 4 位 </span><br><span class="line">%y 年, 数字, 2 位 </span><br><span class="line">%a 缩写的星期名字(Sun……Sat) </span><br><span class="line">%d 月份中的天数, 数字(00……31) </span><br><span class="line">%e 月份中的天数, 数字(0……31) </span><br><span class="line">%m 月, 数字(01……12) </span><br><span class="line">%c 月, 数字(1……12) </span><br><span class="line">%b 缩写的月份名字(Jan……Dec) </span><br><span class="line">%j 一年中的天数(001……366) </span><br><span class="line">%H 小时(00……23) </span><br><span class="line">%k 小时(0……23) </span><br><span class="line">%h 小时(01……12) </span><br><span class="line">%I 小时(01……12) </span><br><span class="line">%l 小时(1……12) </span><br><span class="line">%i 分钟, 数字(00……59)                                        </span><br><span class="line">%r 时间,12 小时(hh:mm:ss [AP]M) </span><br><span class="line">%T 时间,24 小时(hh:mm:ss) </span><br><span class="line">%S 秒(00……59) </span><br><span class="line">%s 秒(00……59) </span><br><span class="line">%p AM或PM </span><br><span class="line">%w 一个星期中的天数(0=Sunday ……6=Saturday ） </span><br><span class="line">%U 星期(0……52), 这里星期天是星期的第一天 </span><br><span class="line">%u 星期(0……52), 这里星期一是星期的第一天 </span><br><span class="line">%% 一个文字“%”。</span><br></pre></td></tr></table></figure>
<p>先记录这些，有坑再补！</p>
<p>参考：<a href="http://www.runoob.com/sql/sql-tutorial.html" target="_blank" rel="noopener">http://www.runoob.com/sql/sql-tutorial.html</a></p>

      
    </div>
    <br>
    <br>
    <a href="http://www.glmapper.com/2018/11/10/seiri-mybatis/" class="more">Read more <i class="icon-angle-right"></i></a>
  </div>
</div>
<hr class="blog-post-sep">

      
	<div class="row">
  <div class="col-md-4 col-sm-4">
    
  </div>
  
    <div class="col-xs-12">
  
    
    <h2 itemprop="name">
      <a class="archive-article-title" href="/2018/11/10/nginxone/">nginx 反向代理和负载均衡策略实战案例</a>
    </h2>


    <ul class="blog-info">
      <li>
      	<i class="fa fa-calendar"></i> 
        <time datetime="2018-11-10T05:25:22.000Z" itemprop="datePublished">2018/11/10</time>

      </li>
      <li><i class="fa fa-comments"></i>
        <a href="http://www.glmapper.com/2018/11/10/nginxone/#disqus_thread" class="article-comment-link">Comments</a>
      </li>
      <li>
	<i class="fa fa-tags"></i>
	
  
    <a href="/tags/nginx/" title="nginx">nginx</a>,
  
    <a href="/tags/代理模式/" title="代理模式">代理模式</a>,
  
    <a href="/tags/负载均衡/" title="负载均衡">负载均衡</a>
  


      </li>
    </ul>
    <div class="blog-item">
      
	<p>欢迎关注：<a href="https://juejin.im/user/5a505bf5518825732a6d50ff" target="_blank" rel="noopener">glmapper_2018</a></p>
<h2 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h2><p>先来看下nginx在web服务器排名上的趋势：<br><img src="https://user-gold-cdn.xitu.io/2018/4/22/162ec151c277a385?w=651&amp;h=544&amp;f=png&amp;s=44941" alt=""></p>
<p>存在即合理，那为什么要使用nginx呢？这得看看nginx能帮我们做些什么。</p>
<p>首先，nginx能做反向代理【关于反向代理和正向代理此处不做说明了，感兴趣的小伙伴自行谷歌】；比方说，我想在本地使用 <a href="http://www.glmapper1.com" target="_blank" rel="noopener">www.glmapper1.com</a> 的域名去访问<a href="http://www.taobao.com。那么这个时候我们就可以通过nginx去实现。" target="_blank" rel="noopener">www.taobao.com。那么这个时候我们就可以通过nginx去实现。</a></p>
<p>再者，nginx能实现负载均衡，什么是负载均衡呢？就是说应用部署在不同的服务器上，但是通过统一的域名进入，nginx则对请求进行分发，将请求分发到不同的服务器上去处理，这样就可以有效的减轻了单台服务器的压力。</p>
<p>在上面这两种情况下，nginx服务器的作用都只是作为分发服务器，真正的内容，我们可以放在其他的服务器上，这样来，还能起到一层安全隔壁的作用，nginx作为隔离层。</p>
<p><strong>解决跨域问题</strong></p>
<blockquote>
<p>同源：URL由协议、域名、端口和路径组成，如果两个URL的协议、域名和端口相同，则表示他们同源。</p>
</blockquote>
<blockquote>
<p>浏览器的同源策略：浏览器的同源策略，限制了来自不同源的”document”或脚本，对当前”document”读取或设置某些属性。从一个域上加载的脚本不允许访问另外一个域的文档属性。</p>
</blockquote>
<p>因为nginx和tomcat不能共用同一端口,url一样，端口不同，这样就会有跨域问题。</p>
<p><code>PS：点到为止，这里本次测试没有涉及，就不妄自菲薄了！！!</code></p>
<h2 id="配置文件解析"><a href="#配置文件解析" class="headerlink" title="配置文件解析"></a>配置文件解析</h2><p>配置文件主要由四部分组成：</p>
<ul>
<li>main(全区设置)</li>
<li>server(主机配置)</li>
<li>http(控制着nginx http处理的所有核心特性)<ul>
<li>location(URL匹配特定位置设置)。</li>
</ul>
</li>
<li>upstream(负载均衡服务器设置)</li>
</ul>
<p>下面以默认的配置文件来说明下具体的配置文件属性含义：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br></pre></td><td class="code"><pre><span class="line">#Nginx的worker进程运行用户以及用户组</span><br><span class="line">#user  nobody;</span><br><span class="line"></span><br><span class="line">#Nginx开启的进程数</span><br><span class="line">worker_processes  1;</span><br><span class="line"></span><br><span class="line">#定义全局错误日志定义类型，[debug|info|notice|warn|crit]</span><br><span class="line">#error_log  logs/error.log;</span><br><span class="line">#error_log  logs/error.log  notice;</span><br><span class="line">#error_log  logs/error.log  info;</span><br><span class="line"></span><br><span class="line">#指定进程ID存储文件位置</span><br><span class="line">#pid        logs/nginx.pid;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">#事件配置</span><br><span class="line">events &#123;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    #use [ kqueue | rtsig | epoll | /dev/poll | select | poll ];</span><br><span class="line">    #epoll模型是Linux内核中的高性能网络I/O模型，如果在mac上面，就用kqueue模型。</span><br><span class="line">    use kqueue;</span><br><span class="line">    </span><br><span class="line">    #每个进程可以处理的最大连接数，理论上每台nginx服务器的最大连接数为worker_processes*worker_connections。理论值：worker_rlimit_nofile/worker_processes</span><br><span class="line">    worker_connections  1024;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">#http参数</span><br><span class="line">http &#123;</span><br><span class="line">    #文件扩展名与文件类型映射表</span><br><span class="line">    include       mime.types;</span><br><span class="line">    #默认文件类型</span><br><span class="line">    default_type  application/octet-stream;</span><br><span class="line">    </span><br><span class="line">    #日志相关定义</span><br><span class="line">    #log_format  main  &apos;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &apos;</span><br><span class="line">    #                  &apos;$status $body_bytes_sent &quot;$http_referer&quot; &apos;</span><br><span class="line">    #                  &apos;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&apos;;</span><br><span class="line">    </span><br><span class="line">    #连接日志的路径，指定的日志格式放在最后。</span><br><span class="line">    #access_log  logs/access.log  main;</span><br><span class="line"></span><br><span class="line">    #开启高效传输模式</span><br><span class="line">    sendfile        on;</span><br><span class="line">    </span><br><span class="line">    #防止网络阻塞</span><br><span class="line">    #tcp_nopush     on;</span><br><span class="line"></span><br><span class="line">    #客户端连接超时时间，单位是秒</span><br><span class="line">    #keepalive_timeout  0;</span><br><span class="line">    keepalive_timeout  65;</span><br><span class="line"></span><br><span class="line">    #开启gzip压缩输出</span><br><span class="line">    #gzip  on;</span><br><span class="line"></span><br><span class="line">    #虚拟主机基本设置</span><br><span class="line">    server &#123;</span><br><span class="line">        #监听的端口号</span><br><span class="line">        listen       80;</span><br><span class="line">        #访问域名</span><br><span class="line">        server_name  localhost;</span><br><span class="line">        </span><br><span class="line">        #编码格式，如果网页格式与当前配置的不同的话将会被自动转码</span><br><span class="line">        #charset koi8-r;</span><br><span class="line"></span><br><span class="line">        #虚拟主机访问日志定义</span><br><span class="line">        #access_log  logs/host.access.log  main;</span><br><span class="line">        </span><br><span class="line">        #对URL进行匹配</span><br><span class="line">        location / &#123;</span><br><span class="line">            #访问路径，可相对也可绝对路径</span><br><span class="line">            root   html;</span><br><span class="line">            #首页文件，匹配顺序按照配置顺序匹配</span><br><span class="line">            index  index.html index.htm;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        #错误信息返回页面</span><br><span class="line">        #error_page  404              /404.html;</span><br><span class="line">        </span><br><span class="line">        # redirect server error pages to the static page /50x.html</span><br><span class="line">        #</span><br><span class="line">        error_page   500 502 503 504  /50x.html;</span><br><span class="line">        location = /50x.html &#123;</span><br><span class="line">            root   html;</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        #访问URL以.php结尾则自动转交给127.0.0.1</span><br><span class="line">        # proxy the PHP scripts to Apache listening on 127.0.0.1:80</span><br><span class="line">        #</span><br><span class="line">        #location ~ \.php$ &#123;</span><br><span class="line">        #    proxy_pass   http://127.0.0.1;</span><br><span class="line">        #&#125;</span><br><span class="line">        </span><br><span class="line">        #php脚本请求全部转发给FastCGI处理</span><br><span class="line">        # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000</span><br><span class="line">        #</span><br><span class="line">        #location ~ \.php$ &#123;</span><br><span class="line">        #    root           html;</span><br><span class="line">        #    fastcgi_pass   127.0.0.1:9000;</span><br><span class="line">        #    fastcgi_index  index.php;</span><br><span class="line">        #    fastcgi_param  SCRIPT_FILENAME  /scripts$fastcgi_script_name;</span><br><span class="line">        #    include        fastcgi_params;</span><br><span class="line">        #&#125;</span><br><span class="line"></span><br><span class="line">        #禁止访问.ht页面</span><br><span class="line">        # deny access to .htaccess files, if Apache&apos;s document root</span><br><span class="line">        # concurs with nginx&apos;s one</span><br><span class="line">        #</span><br><span class="line">        #location ~ /\.ht &#123;</span><br><span class="line">        #    deny  all;</span><br><span class="line">        #&#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    #第二个虚拟主机配置</span><br><span class="line">    # another virtual host using mix of IP-, name-, and port-based configuration</span><br><span class="line">    #</span><br><span class="line">    #server &#123;</span><br><span class="line">    #    listen       8000;</span><br><span class="line">    #    listen       somename:8080;</span><br><span class="line">    #    server_name  somename  alias  another.alias;</span><br><span class="line"></span><br><span class="line">    #    location / &#123;</span><br><span class="line">    #        root   html;</span><br><span class="line">    #        index  index.html index.htm;</span><br><span class="line">    #    &#125;</span><br><span class="line">    #&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    #HTTPS虚拟主机定义</span><br><span class="line">    # HTTPS server</span><br><span class="line">    #</span><br><span class="line">    #server &#123;</span><br><span class="line">    #    listen       443 ssl;</span><br><span class="line">    #    server_name  localhost;</span><br><span class="line"></span><br><span class="line">    #    ssl_certificate      cert.pem;</span><br><span class="line">    #    ssl_certificate_key  cert.key;</span><br><span class="line"></span><br><span class="line">    #    ssl_session_cache    shared:SSL:1m;</span><br><span class="line">    #    ssl_session_timeout  5m;</span><br><span class="line"></span><br><span class="line">    #    ssl_ciphers  HIGH:!aNULL:!MD5;</span><br><span class="line">    #    ssl_prefer_server_ciphers  on;</span><br><span class="line"></span><br><span class="line">    #    location / &#123;</span><br><span class="line">    #        root   html;</span><br><span class="line">    #        index  index.html index.htm;</span><br><span class="line">    #    &#125;</span><br><span class="line">    #&#125;</span><br><span class="line">    include servers/*;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="反向代理实例"><a href="#反向代理实例" class="headerlink" title="反向代理实例"></a>反向代理实例</h2><p>假设我现在需要本地访问<a href="http://www.baidu.com;配置如下：" target="_blank" rel="noopener">www.baidu.com;配置如下：</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    #监听80端口</span><br><span class="line">    listen 80;</span><br><span class="line">    server_name localhost;</span><br><span class="line">     # individual nginx logs for this web vhost</span><br><span class="line">    access_log /tmp/access.log;</span><br><span class="line">    error_log  /tmp/error.log ;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        proxy_pass http://www.baidu.com;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>验证结果：</p>
<p><img src="https://user-gold-cdn.xitu.io/2018/4/22/162ec5d6cc09a498?w=2584&amp;h=1486&amp;f=png&amp;s=249055" alt=""></p>
<p>可以看到，我在浏览器中使用localhost打开了百度的首页…</p>
<h2 id="负载均衡实例"><a href="#负载均衡实例" class="headerlink" title="负载均衡实例"></a>负载均衡实例</h2><p>下面主要验证最常用的三种负载策略。虚拟主机配置：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">server &#123;</span><br><span class="line">    #监听80端口</span><br><span class="line">    listen 80;</span><br><span class="line">    server_name localhost;</span><br><span class="line">    </span><br><span class="line">    # individual nginx logs for this web vhost</span><br><span class="line">    access_log /tmp/access.log;</span><br><span class="line">    error_log  /tmp/error.log ;</span><br><span class="line"></span><br><span class="line">    location / &#123;</span><br><span class="line">        #负载均衡</span><br><span class="line">        #轮询 </span><br><span class="line">        #proxy_pass http://polling_strategy;</span><br><span class="line">        #weight权重</span><br><span class="line">        #proxy_pass http://weight_strategy;</span><br><span class="line">        #ip_hash</span><br><span class="line">        # proxy_pass http://ip_hash_strategy;</span><br><span class="line">        #fair</span><br><span class="line">        # proxy_pass http://fair_strategy;</span><br><span class="line">        #url_hash</span><br><span class="line">        # proxy_pass http://url_hash_strategy;</span><br><span class="line">        #重定向</span><br><span class="line">        #rewrite ^ http://localhost:8080;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="轮询策略"><a href="#轮询策略" class="headerlink" title="轮询策略"></a>轮询策略</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"># 1、轮询（默认）</span><br><span class="line"># 每个请求按时间顺序逐一分配到不同的后端服务器，如果后端服务器down掉，能自动剔除。 </span><br><span class="line">upstream polling_strategy &#123; </span><br><span class="line">    server glmapper.net:8080; # 应用服务器1</span><br><span class="line">    server glmapper.net:8081; # 应用服务器2</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>测试结果（通过端口号来区分当前访问）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">8081：hello</span><br><span class="line">8080：hello</span><br><span class="line">8081：hello</span><br><span class="line">8080：hello</span><br></pre></td></tr></table></figure>
<h3 id="权重策略"><a href="#权重策略" class="headerlink" title="权重策略"></a>权重策略</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">#2、指定权重</span><br><span class="line">#指定轮询几率，weight和访问比率成正比，用于后端服务器性能不均的情况。 </span><br><span class="line">upstream  weight_strategy &#123; </span><br><span class="line">    server glmapper.net:8080 weight=1; # 应用服务器1</span><br><span class="line">    server glmapper.net:8081 weight=9; # 应用服务器2</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>测试结果：总访问次数15次，根据上面的权重配置，两台机器的访问比重：2：13；满足预期！</p>
<h3 id="ip-hash策略"><a href="#ip-hash策略" class="headerlink" title="ip hash策略"></a>ip hash策略</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">#3、IP绑定 ip_hash</span><br><span class="line">#每个请求按访问ip的hash结果分配，这样每个访客固定访问一个后端服务器，</span><br><span class="line">#可以解决session的问题;在不考虑引入分布式session的情况下，</span><br><span class="line">#原生HttpSession只对当前servlet容器的上下文环境有效</span><br><span class="line">upstream ip_hash_strategy &#123; </span><br><span class="line">    ip_hash; </span><br><span class="line">    server glmapper.net:8080; # 应用服务器1</span><br><span class="line">    server glmapper.net:8081; # 应用服务器2</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>iphash 算法:ip是基本的点分十进制，将ip的前三个端作为参数加入hash函数。这样做的目的是保证ip地址前三位相同的用户经过hash计算将分配到相同的后端server。作者的这个考虑是极为可取的，因此ip地址前三位相同通常意味着来着同一个局域网或者相邻区域，使用相同的后端服务让nginx在一定程度上更具有一致性。</p>
</blockquote>
<p>为什么说要解释下iphash,因为采坑了；和猪弟在进行这个策略测试时使用了5台机器来测试的，5台机器均在同一个局域网内【192.168.3.X】;测试时发现5台机器每次都路由到了同一个服务器上，一开始以为是配置问题，但是排查之后也排除了这个可能性。最后考虑到可能是对于同网段的ip做了特殊处理，验证之后确认了猜测。</p>
<h3 id="其他负载均衡策略"><a href="#其他负载均衡策略" class="headerlink" title="其他负载均衡策略"></a>其他负载均衡策略</h3><p>这里因为需要安装三方插件，时间有限就不验证了，知悉即可！<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">#4、fair（第三方）</span><br><span class="line">#按后端服务器的响应时间来分配请求，响应时间短的优先分配。 </span><br><span class="line">upstream fair_strategy &#123; </span><br><span class="line">    server glmapper.net:8080; # 应用服务器1</span><br><span class="line">    server glmapper.net:8081; # 应用服务器2</span><br><span class="line">    fair; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line">#5、url_hash（第三方）</span><br><span class="line">#按访问url的hash结果来分配请求，使每个url定向到同一个后端服务器，</span><br><span class="line">#后端服务器为缓存时比较有效。 </span><br><span class="line">upstream url_hash_strategy &#123; </span><br><span class="line">    server glmapper.net:8080; # 应用服务器1</span><br><span class="line">    server glmapper.net:8081; # 应用服务器2 </span><br><span class="line">    hash $request_uri; </span><br><span class="line">    hash_method crc32; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="重定向rewrite"><a href="#重定向rewrite" class="headerlink" title="重定向rewrite"></a>重定向rewrite</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">location / &#123;</span><br><span class="line">    #重定向</span><br><span class="line">    #rewrite ^ http://localhost:8080;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>验证思路：本地使用localhost:80端口进行访问，根据nginx的配置，如果重定向没有生效，则最后会停留在当前localhost:80这个路径，浏览器中的地址栏地址不会发生改变；如果生效了则地址栏地址变为localhost:8080；</p>
<p>通过验证，满足预期！</p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>本文先对nginx的作用和基本的配置做了简单说明；然后通过负载均衡的实例测试了不同负载均衡算法的具体应用反馈结果。帮助自己更加深刻的理解nginx服务器中的一些配置细节。感谢刘秘提供的helloworld程序【基于springboot的脚手架，有需要的可以联系他获取；还有就是刘秘是个男的…😜】</p>
<h2 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h2><ul>
<li><a href="http://nginx.org/" target="_blank" rel="noopener">http://nginx.org/</a></li>
<li><a href="https://www.nginx.com/" target="_blank" rel="noopener">https://www.nginx.com/</a></li>
<li><a href="http://www.sohu.com/a/161411719_324809" target="_blank" rel="noopener">http://www.sohu.com/a/161411719_324809</a></li>
</ul>

      
    </div>
    <br>
    <br>
    <a href="http://www.glmapper.com/2018/11/10/nginxone/" class="more">Read more <i class="icon-angle-right"></i></a>
  </div>
</div>
<hr class="blog-post-sep">

      
    </div>
    
      <div id="page-nav" class="pagination">
	<a class="extend prev" rel="prev" href="/page/10/">Prev</a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/9/">9</a><a class="page-number" href="/page/10/">10</a><span class="page-number current">11</span><a class="page-number" href="/page/12/">12</a><a class="page-number" href="/page/13/">13</a><a class="extend next" rel="next" href="/page/12/">Next</a>
      </div>
    
  </section>

</div>

</div>

  </div>
  </div>



    <!-- BEGIN PRE-FOOTER -->
    <div class="pre-footer">
      <div class="container">
        <div class="row">
          <!-- BEGIN BOTTOM ABOUT BLOCK -->
          <div class="col-md-4 col-sm-6 pre-footer-col">
            <h2>About Us</h2>
            <p>Computer Lab is a software development and marketing company based in Brooklyn, New York. <br><br> Computer Lab was founded in 2015, and is focused on so on and so forth.</p>
          </div>
          <!-- END BOTTOM ABOUT BLOCK -->

          <!-- BEGIN BOTTOM CONTACTS -->
          <div class="col-md-4 col-sm-6 pre-footer-col">
            <h2>Contact</h2>
            <address class="margin-bottom-40">
              140 Metropolitan Avenue<br>
              5th Floor<br>
              Brooklyn, NY 11249<br>
              Phone: 716-472-4484<br>
              Email: <a href="mailto:ptsteadman@gmail.com">ptsteadman@gmail.com</a><br>
            </address>
          </div>
          <!-- END BOTTOM CONTACTS -->

	
          <!-- BEGIN TWITTER BLOCK --> 
          <div class="col-md-4 col-sm-6 pre-footer-col">

	  <a data-tweet-limit="1" class="twitter-timeline" href="https://twitter.com/computerlab_" data-widget-id="678830341331820544">Tweets by @computerlab_</a>

	  <script>!function(d,s,id){var
	  js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>

          </div>
          <!-- END TWITTER BLOCK -->
	
        </div>
      </div>
    </div>
    <!-- END PRE-FOOTER -->

    <!-- BEGIN FOOTER -->
    <div class="footer">
      <div class="container">
        <div class="row">
          <!-- BEGIN COPYRIGHT -->
          <div class="col-md-6 col-sm-6 padding-top-10">
                  &copy; 2020 glmapper<br>
 <a href="javascript:;">Privacy Policy</a> | <a href="javascript:;">Terms of Service</a>
          </div>
          <!-- END COPYRIGHT -->
	  <!-- BEGIN SOCIAL -->
<div class="col-md-6 col-sm-6">
  <ul class="social-footer list-unstyled list-inline pull-right">
    
      <li><a href="https://github.com/ptsteadman"><i class="fa fa-github"></i></a></li>
    
      <li><a href="https://twitter.com/ptsteadman"><i class="fa fa-twitter"></i></a></li>
    
      <li><a href="https://www.facebook.com/ptsteadman"><i class="fa fa-facebook"></i></a></li>
    
      <li><a href="/atom.xml"><i class="fa fa-rss"></i></a></li>
    
      <li><a href="https://linkedin.com/in/ptsteadman"><i class="fa fa-linkedin"></i></a></li>
    
      <li><a href="http://stackoverflow.com/users/2480493/patrick-steadman"><i class="fa fa-stackoverflow"></i></a></li>
    
  </ul>  
</div>
<!-- END SOCIAL -->

        </div>
      </div>
    </div>
    <!-- END FOOTER -->

  <!-- BEGIN CORE PLUGINS (REQUIRED FOR ALL PAGES) -->
<!--[if lt IE 9]>
<script src="/metronic/assets/plugins/respond.min.js"></script>
<![endif]--> 
<script src="/metronic/assets/plugins/jquery.min.js"></script>
<script src="/metronic/assets/plugins/jquery-migrate.min.js"></script>
<script src="/metronic/assets/plugins/bootstrap/js/bootstrap.min.js"></script>
<script src="/metronic/assets/corporate/scripts/back-to-top.js"></script>
<script src="/metronic/assets/plugins/owl.carousel/owl.carousel.min.js"></script>
<script src="/metronic/assets/corporate/scripts/layout.js"></script>
<script src="/js/wow.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script type="text/javascript">
    jQuery(document).ready(function() {
        Layout.init();    
        Layout.initOWL();
        Layout.initTwitter();
        Layout.initFixHeaderWithPreHeader(); /* Switch On Header Fixing (only if you have pre-header) */
        Layout.initNavScrolling(); 
	new WOW().init();
    });
</script>
<!-- END CORE PLUGINS -->

<!-- BEGIN PAGE-SPECIFIC PLUGINS --> 







<!-- END PAGE-SPECIFIC PLUGINS --> 

<!-- BEGIN INTEGRATIONS -->





<!-- END INTEGRATIONS -->

</body>
</html>
