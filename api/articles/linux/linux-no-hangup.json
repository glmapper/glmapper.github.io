{"title":"Linux nohup 命令","uid":"abbcd011f0be9dc628ed542e40f49896","slug":"linux/linux-no-hangup","date":"2023-08-15T02:12:22.000Z","updated":"2024-07-05T04:09:05.775Z","comments":true,"path":"api/articles/linux/linux-no-hangup.json","keywords":"宋国磊, glmapper, 卫恒, 分享, 开源","cover":null,"content":"<p>nohup 表示不挂断地运行命令，是 no hangup 的缩写，语法格式如下：</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">nohup</span> Command [ Arg ... ] [　&amp; ]</span><br></pre></td></tr></table></figure>\n<ul>\n<li>nohup 命令运行由 Command参数和任何相关的 Arg参数指定的命令，忽略所有挂断（SIGHUP）信号。</li>\n<li>nohup放在命令的开头，表示不挂起（no hang up），也即，关闭终端或者退出某个账号，进程也继续保持运行状态，一般配合&amp;符号一起使用。如 nohup command &amp;。</li>\n</ul>\n<span id=\"more\"></span>\n\n<h2 id=\"man-nohup\"><a href=\"#man-nohup\" class=\"headerlink\" title=\"man nohup\"></a>man nohup</h2><figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">NOHUP(1)                                                                                                                                                                  User Commands                                                                                                                                                                 NOHUP(1)</span><br><span class=\"line\"></span><br><span class=\"line\">NAME</span><br><span class=\"line\">       <span class=\"built_in\">nohup</span> - run a <span class=\"built_in\">command</span> immune to hangups, with output to a non-tty</span><br><span class=\"line\"></span><br><span class=\"line\">SYNOPSIS</span><br><span class=\"line\">       <span class=\"built_in\">nohup</span> COMMAND [ARG]...</span><br><span class=\"line\">       <span class=\"built_in\">nohup</span> OPTION</span><br><span class=\"line\"></span><br><span class=\"line\">DESCRIPTION</span><br><span class=\"line\">       Run COMMAND, ignoring hangup signals.</span><br><span class=\"line\"></span><br><span class=\"line\">       --<span class=\"built_in\">help</span> display this <span class=\"built_in\">help</span> and <span class=\"built_in\">exit</span></span><br><span class=\"line\"></span><br><span class=\"line\">       --version</span><br><span class=\"line\">              output version information and <span class=\"built_in\">exit</span></span><br><span class=\"line\"></span><br><span class=\"line\">       If standard input is a terminal, redirect it from /dev/null.  If standard output is a terminal, append output to <span class=\"string\">&#x27;nohup.out&#x27;</span> <span class=\"keyword\">if</span> possible, <span class=\"string\">&#x27;$HOME/nohup.out&#x27;</span> otherwise.  If standard error is a terminal, redirect it to standard output.  To save output to FILE, use <span class=\"string\">&#x27;nohup COMMAND &gt; FILE&#x27;</span>.</span><br><span class=\"line\"></span><br><span class=\"line\">       NOTE: your shell may have its own version of <span class=\"built_in\">nohup</span>, <span class=\"built_in\">which</span> usually supersedes the version described here.  Please refer to your shell<span class=\"string\">&#x27;s documentation for details about the options it supports.</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">       GNU coreutils online help: &lt;http://www.gnu.org/software/coreutils/&gt; Report nohup translation bugs to &lt;http://translationproject.org/team/&gt;</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">AUTHOR</span></span><br><span class=\"line\"><span class=\"string\">       Written by Jim Meyering.</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">COPYRIGHT</span></span><br><span class=\"line\"><span class=\"string\">       Copyright © 2013 Free Software Foundation, Inc.  License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;.</span></span><br><span class=\"line\"><span class=\"string\">       This is free software: you are free to change and redistribute it.  There is NO WARRANTY, to the extent permitted by law.</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">SEE ALSO</span></span><br><span class=\"line\"><span class=\"string\">       The full documentation for nohup is maintained as a Texinfo manual.  If the info and nohup programs are properly installed at your site, the command</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">              info coreutils &#x27;</span><span class=\"built_in\">nohup</span> invocation<span class=\"string\">&#x27;</span></span><br><span class=\"line\"><span class=\"string\"></span></span><br><span class=\"line\"><span class=\"string\">       should give you access to the complete manual.</span></span><br></pre></td></tr></table></figure>\n\n<p>通过上面 man nohup 可以了解到：</p>\n<ul>\n<li>如果不将 nohup 命令的输出重定向，输出将附加到当前目录的 nohup.out 文件中。</li>\n<li>如果当前目录的 nohup.out 文件不可写，输出重定向到 $HOME&#x2F;nohup.out 文件中。</li>\n</ul>\n<h2 id=\"nohup-重定向输出\"><a href=\"#nohup-重定向输出\" class=\"headerlink\" title=\"nohup 重定向输出\"></a>nohup 重定向输出</h2><p>主要是针对常见的如：<code>2&gt;&amp;1</code>、<code>/dev/null</code> 等参数的解释。下表是各字符的含义解释：</p>\n<table>\n<thead>\n<tr>\n<th>项</th>\n<th>描述</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>&#x2F;dev&#x2F;null</td>\n<td>表示空设备文件</td>\n</tr>\n<tr>\n<td>0</td>\n<td>stdin 标准输入</td>\n</tr>\n<tr>\n<td>1</td>\n<td>stdout 标准输出</td>\n</tr>\n<tr>\n<td>2</td>\n<td>stderr 标准错误</td>\n</tr>\n<tr>\n<td>&gt; file</td>\n<td>将标准输出输出到file中，也就相当于 1&gt;file;</td>\n</tr>\n<tr>\n<td>2 &gt; error</td>\n<td>将错误输出到error文件中</td>\n</tr>\n<tr>\n<td>2&gt;&amp;1</td>\n<td>将错误重定向到标准输出上</td>\n</tr>\n<tr>\n<td>2&gt;&amp;1 &gt;file</td>\n<td>将错误输出到终端，标准输出重定向到文件file，等同于 &gt; file 2&gt;&amp;1</td>\n</tr>\n</tbody></table>\n<p>有一点需要注意，对于 <code>&gt; file</code> 和 <code>&gt;&gt; file</code></p>\n<ul>\n<li><strong>&gt;</strong> 表示的是定向输出到文件，如果文件不存在，就创建文件；如果文件存在，就将其清空；一般我们备份清理日志文件的时候，就是这种方法：先备份日志，再用<code>&gt;</code>，将日志文件清空（文件大小变成0字节）；</li>\n<li><strong>&gt;&gt;</strong> 表示的是将输出内容追加到目标文件中。如果文件不存在，就创建文件；如果文件存在，则将新的内容追加到那个文件的末尾，该文件中的原有内容不受影响。</li>\n</ul>\n<h2 id=\"符号\"><a href=\"#符号\" class=\"headerlink\" title=\"&amp; 符号\"></a>&amp; 符号</h2><p><code>&amp;</code> 放在命令到结尾，表示后台运行，防止终端一直被某个进程占用，这样终端可以执行别到任务，配合 &gt;file 2&gt;&amp;1 可以将 log 保存到某个文件中，但如果终端关闭，则进程也停止运行。如 command &gt; file.log 2&gt;&amp;1 &amp; 。</p>\n<h2 id=\"使用\"><a href=\"#使用\" class=\"headerlink\" title=\"使用\"></a>使用</h2><ul>\n<li><p>在控制台输出日志</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">nohup</span> java -jar <span class=\"variable\">$GLMAPPER_APP_NAME</span>.jar  &amp;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>不输出控制台日志</p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"built_in\">nohup</span> java -jar <span class=\"variable\">$GLMAPPER_APP_NAME</span>.jar  &gt;/dev/null 2&gt;&amp;1 &amp;</span><br></pre></td></tr></table></figure></li>\n</ul>\n<p>一般情况下，我们的服务都是有配置指定的日志输出路径的，比如 java 中使用 logback 作为日志组件，在 logback-spring.xml 配置文件中指定了日志目录，那么这种情况下，我们就可以不需要将日志输出到控制台，则使用第二种方式就比较合理。</p>\n<p>对于有些服务如果启动后将日志输出到控制台，然后默认产生一个 nohup.out 文件，随着服务运行时间变长，nohup.out 文件可能会非常大；如果期望在不停服务的情况下清空 nohup.out 文件，则可以通过以下几种方式来完成</p>\n<ul>\n<li>cp &#x2F;dev&#x2F;null nohup.out</li>\n<li>cat &#x2F;dev&#x2F;null &gt; nohup.out</li>\n<li>echo “” &gt; nohup.out</li>\n</ul>\n<p>最后还是建议配置日志路径，不要使用默认路径将日志输出。</p>\n","text":"nohup 表示不挂断地运行命令，是 no hangup 的缩写，语法格式如下： 1nohup Command [ Arg ... ] [ & ] nohup ...","permalink":"/post/linux/linux-no-hangup","photos":[],"count_time":{"symbolsCount":"3.6k","symbolsTime":"3 mins."},"categories":[{"name":"Linux","slug":"Linux","count":9,"path":"api/categories/Linux.json"}],"tags":[{"name":"linux","slug":"linux","count":9,"path":"api/tags/linux.json"},{"name":"nohup","slug":"nohup","count":1,"path":"api/tags/nohup.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#man-nohup\"><span class=\"toc-text\">man nohup</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#nohup-%E9%87%8D%E5%AE%9A%E5%90%91%E8%BE%93%E5%87%BA\"><span class=\"toc-text\">nohup 重定向输出</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%AC%A6%E5%8F%B7\"><span class=\"toc-text\">&amp; 符号</span></a></li><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E4%BD%BF%E7%94%A8\"><span class=\"toc-text\">使用</span></a></li></ol>","author":{"name":"glmapper","slug":"blog-author","avatar":"https://glmapper-blog.oss-cn-hangzhou.aliyuncs.com/common/favicon.ico","link":"/","description":"开放，开源，分享，共享","socials":{"github":"https://github.com/glmapper","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/2412872703","zhihu":"","csdn":"","juejin":"https://juejin.cn/user/3227821827961806","customs":{"sofastack":{"icon":"https://glmapper-blog.oss-cn-hangzhou.aliyuncs.com/common/sofastack.svg","link":"https://www.sofastack.tech/"}}}},"mapped":true,"hidden":false,"prev_post":{"title":"如何编写测试用例","uid":"ddb33e3231bb937dcbd835cfc8516ae1","slug":"tests/test-about-write-test","date":"2023-09-08T09:15:51.000Z","updated":"2024-07-05T04:09:05.844Z","comments":true,"path":"api/articles/tests/test-about-write-test.json","keywords":"宋国磊, glmapper, 卫恒, 分享, 开源","cover":[],"text":"代码质量管理是软件开发过程中的关键组成部分，比如我们常说的代码规范、代码可读性、单元测试和测试覆盖率等，对于研发人员来说单元测试和测试覆盖率是保障自己所编写代码...","permalink":"/post/tests/test-about-write-test","photos":[],"count_time":{"symbolsCount":"10k","symbolsTime":"10 mins."},"categories":[{"name":"test","slug":"test","count":5,"path":"api/categories/test.json"}],"tags":[{"name":"test","slug":"test","count":5,"path":"api/tags/test.json"},{"name":"junit","slug":"junit","count":2,"path":"api/tags/junit.json"}],"author":{"name":"glmapper","slug":"blog-author","avatar":"https://glmapper-blog.oss-cn-hangzhou.aliyuncs.com/common/favicon.ico","link":"/","description":"开放，开源，分享，共享","socials":{"github":"https://github.com/glmapper","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/2412872703","zhihu":"","csdn":"","juejin":"https://juejin.cn/user/3227821827961806","customs":{"sofastack":{"icon":"https://glmapper-blog.oss-cn-hangzhou.aliyuncs.com/common/sofastack.svg","link":"https://www.sofastack.tech/"}}}}},"next_post":{"title":"基于 CentOS 7.6 + Samba 搭建文件服务器","uid":"9d6bba182f887ce7358e9129a5f246bb","slug":"tools/tool-samba-file-server","date":"2023-05-31T02:00:35.000Z","updated":"2024-07-05T04:09:05.849Z","comments":true,"path":"api/articles/tools/tool-samba-file-server.json","keywords":"宋国磊, glmapper, 卫恒, 分享, 开源","cover":null,"text":"出于产品、解决方案同事的诉求，需要搭建一个用于共享文件的平台，因此基于 Samba 搭建了一个共享文件服务器，这里记录一下，以便用于后续维护参阅。 Samba ...","permalink":"/post/tools/tool-samba-file-server","photos":[],"count_time":{"symbolsCount":"4.3k","symbolsTime":"4 mins."},"categories":[{"name":"工具","slug":"工具","count":3,"path":"api/categories/工具.json"}],"tags":[{"name":"tool","slug":"tool","count":2,"path":"api/tags/tool.json"},{"name":"samba","slug":"samba","count":1,"path":"api/tags/samba.json"}],"author":{"name":"glmapper","slug":"blog-author","avatar":"https://glmapper-blog.oss-cn-hangzhou.aliyuncs.com/common/favicon.ico","link":"/","description":"开放，开源，分享，共享","socials":{"github":"https://github.com/glmapper","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"https://weibo.com/u/2412872703","zhihu":"","csdn":"","juejin":"https://juejin.cn/user/3227821827961806","customs":{"sofastack":{"icon":"https://glmapper-blog.oss-cn-hangzhou.aliyuncs.com/common/sofastack.svg","link":"https://www.sofastack.tech/"}}}}}}